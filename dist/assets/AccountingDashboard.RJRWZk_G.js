import{r as a,A as N,j as e,P as me,Y as xe,$ as K,a0 as ue}from"./index.UZcXu8dh.js";const he=()=>{var b,H;const[x,R]=a.useState([]),[M,d]=a.useState(null),[O,$]=a.useState(!0),[j,S]=a.useState(null),[V,g]=a.useState("pending"),[W,B]=a.useState(null),[i,p]=a.useState(!1),[u,w]=a.useState(!1),[A,y]=a.useState(""),[C,_]=a.useState(!1);a.useEffect(()=>{f()},[V]);const f=async()=>{$(!0),S(null);try{const z=await(await fetch(`${N}/accounting/admin/get-pending-payments?status=${V}&limit=100`,{method:"GET",credentials:"include"})).json();z.success?(R(z.data.payments),d(z.data.statistics)):S(z.message||"Failed to fetch payments")}catch(t){S("Network error occurred"),console.error("Error:",t)}finally{$(!1)}},r=async t=>{if(confirm("Are you sure you want to verify this payment?")){_(!0);try{const q=await(await fetch(`${N}/accounting/admin/verify-payment`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({payment_id:t})})).json();q.success?(alert("Payment verified successfully!"),f()):alert(q.message||"Failed to verify payment")}catch(z){alert("Network error occurred"),console.error("Error:",z)}finally{_(!1)}}},L=async()=>{if(!A.trim()){alert("Please provide a rejection reason");return}_(!0);try{const z=await(await fetch(`${N}/accounting/admin/reject-payment`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({payment_id:W.id,reason:A})})).json();z.success?(alert("Payment rejected successfully!"),w(!1),y(""),B(null),f()):alert(z.message||"Failed to reject payment")}catch(t){alert("Network error occurred"),console.error("Error:",t)}finally{_(!1)}},v=t=>{B(t),p(!0)},l=t=>{B(t),w(!0)},k=t=>{switch(t){case"pending":return"bg-yellow-100 text-yellow-800";case"verified":return"bg-green-100 text-green-800";case"rejected":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}};return e.jsxs("div",{className:"p-3 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Payment Verification"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Review and verify bank transfer payments from parents"})]}),M&&e.jsxs("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-3 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-0",children:[e.jsx("div",{className:"p-2 sm:p-3 rounded-full bg-blue-100 text-blue-600 w-fit",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsxs("div",{className:"sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Total Payments"}),e.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:M.total_payments})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-3 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-0",children:[e.jsx("div",{className:"p-2 sm:p-3 rounded-full bg-yellow-100 text-yellow-600 w-fit",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Pending"}),e.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:M.pending_count}),e.jsxs("p",{className:"text-xs text-gray-500",children:["₦",(b=M.pending_amount)==null?void 0:b.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-3 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-0",children:[e.jsx("div",{className:"p-2 sm:p-3 rounded-full bg-green-100 text-green-600 w-fit",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsxs("div",{className:"sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Verified"}),e.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:M.verified_count}),e.jsxs("p",{className:"text-xs text-gray-500",children:["₦",(H=M.verified_amount)==null?void 0:H.toLocaleString()]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-3 sm:p-6",children:e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2 sm:gap-0",children:[e.jsx("div",{className:"p-2 sm:p-3 rounded-full bg-red-100 text-red-600 w-fit",children:e.jsx("svg",{className:"w-5 h-5 sm:w-6 sm:h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsxs("div",{className:"sm:ml-4",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-gray-600",children:"Rejected"}),e.jsx("p",{className:"text-xl sm:text-2xl font-semibold text-gray-900",children:M.rejected_count})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsx("nav",{className:"flex -mb-px overflow-x-auto",children:["pending","verified","rejected"].map(t=>e.jsxs("button",{onClick:()=>g(t),className:`py-3 sm:py-4 px-4 sm:px-6 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${V===t?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:[t.charAt(0).toUpperCase()+t.slice(1)," Payments"]},t))})})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:O?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):j?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600",children:j}),e.jsx("button",{onClick:f,className:"mt-4 text-primary-600 hover:text-primary-700 font-medium",children:"Try Again"})]}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No payments found"}),e.jsxs("p",{className:"mt-1 text-sm text-gray-500",children:["No ",V," payments at the moment."]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block lg:hidden p-3 space-y-3",children:x.map(t=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsxs("span",{className:"text-xs font-medium text-gray-500",children:["#",t.receipt_no]}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${k(t.verification_status)}`,children:t.verification_status})]}),e.jsx("h3",{className:"font-medium text-gray-900 text-sm mb-1",children:t.student.name}),e.jsxs("p",{className:"text-xs text-gray-500",children:[t.student.class," - ",t.student.admission_no]})]}),e.jsx("div",{className:"text-right ml-2",children:e.jsxs("p",{className:"font-semibold text-gray-900 text-sm whitespace-nowrap",children:["₦",t.amount.toLocaleString()]})})]}),e.jsxs("div",{className:"space-y-1.5 text-xs mb-3",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Parent:"}),e.jsx("span",{className:"text-gray-900 ml-1",children:t.parent.name||"N/A"})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Fee:"}),e.jsx("span",{className:"text-gray-900 ml-1",children:t.fee.category})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Session/Term:"}),e.jsxs("span",{className:"text-gray-900 ml-1",children:[t.fee.session," - ",t.fee.term]})]}),t.bank_name&&e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Bank:"}),e.jsxs("span",{className:"text-gray-900 ml-1",children:[t.bank_name," (",t.account_number,")"]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"font-medium text-gray-600",children:"Date:"}),e.jsx("span",{className:"text-gray-900 ml-1",children:new Date(t.payment_date).toLocaleDateString()})]}),t.rejection_reason&&e.jsxs("div",{className:"text-xs text-red-600 mt-2 bg-red-50 p-2 rounded",children:[e.jsx("span",{className:"font-medium",children:"Reason:"})," ",t.rejection_reason]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200",children:[t.has_receipt_image&&e.jsx("button",{onClick:()=>v(t),className:"text-blue-600 hover:text-blue-900 p-1.5",title:"View Receipt",children:e.jsxs("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.verification_status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>r(t.id),disabled:C,className:"text-green-600 hover:text-green-900 disabled:opacity-50 p-1.5",title:"Verify Payment",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("button",{onClick:()=>l(t),disabled:C,className:"text-red-600 hover:text-red-900 disabled:opacity-50 p-1.5",title:"Reject Payment",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})]},t.id))}),e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Receipt No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Parent"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Fee Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Details"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(t=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:t.receipt_no}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:t.student.name}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.student.class," - ",t.student.admission_no]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.parent.name||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:t.parent.email||"N/A"})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.fee.category}),e.jsxs("div",{className:"text-sm text-gray-500",children:[t.fee.session," - ",t.fee.term]})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-semibold text-gray-900",children:["₦",t.amount.toLocaleString()]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("div",{className:"text-sm text-gray-900",children:t.bank_name||"N/A"}),e.jsx("div",{className:"text-sm text-gray-500",children:t.account_number||"N/A"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(t.payment_date).toLocaleDateString()}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${k(t.verification_status)}`,children:t.verification_status}),t.rejection_reason&&e.jsx("div",{className:"text-xs text-red-600 mt-1",children:t.rejection_reason})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-2",children:[t.has_receipt_image&&e.jsx("button",{onClick:()=>v(t),className:"text-blue-600 hover:text-blue-900",title:"View Receipt",children:e.jsxs("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:[e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M15 12a3 3 0 11-6 0 3 3 0 016 0z"}),e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M2.458 12C3.732 7.943 7.523 5 12 5c4.478 0 8.268 2.943 9.542 7-1.274 4.057-5.064 7-9.542 7-4.477 0-8.268-2.943-9.542-7z"})]})}),t.verification_status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx("button",{onClick:()=>r(t.id),disabled:C,className:"text-green-600 hover:text-green-900 disabled:opacity-50",title:"Verify Payment",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})}),e.jsx("button",{onClick:()=>l(t),disabled:C,className:"text-red-600 hover:text-red-900 disabled:opacity-50",title:"Reject Payment",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})]})})]},t.id))})]})})]})}),i&&W&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:()=>p(!1),children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-11/12 md:w-3/4 lg:w-1/2 shadow-lg rounded-md bg-white",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsxs("h3",{className:"text-lg font-medium text-gray-900",children:["Payment Receipt - ",W.receipt_no]}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsx("div",{className:"mt-2",children:W.receipt_image?e.jsx("img",{src:W.receipt_image,alt:"Payment Receipt",className:"w-full h-auto max-h-[70vh] object-contain"}):e.jsx("p",{className:"text-gray-500 text-center py-8",children:"No receipt image available"})})]})}),u&&W&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:()=>w(!1),children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:t=>t.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Reject Payment"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("div",{className:"mt-2",children:[e.jsx("p",{className:"text-sm text-gray-500 mb-4",children:"Please provide a reason for rejecting this payment. The parent will be notified."}),e.jsx("textarea",{value:A,onChange:t=>y(t.target.value),rows:4,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Amount doesn't match, invalid receipt, etc."}),e.jsxs("div",{className:"flex gap-3 mt-4",children:[e.jsx("button",{onClick:L,disabled:C||!A.trim(),className:"flex-1 bg-red-600 text-white px-4 py-2 rounded-md hover:bg-red-700 disabled:opacity-50",children:C?"Processing...":"Reject Payment"}),e.jsx("button",{onClick:()=>{w(!1),y("")},className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})]})})]})},pe=()=>{const[x,R]=a.useState([]),[M,d]=a.useState(!0),[O,$]=a.useState(null),[j,S]=a.useState(!1),[V,g]=a.useState(!1),[W,B]=a.useState(null),[i,p]=a.useState(!1),[u,w]=a.useState({bank_name:"",account_number:"",account_name:"",account_type:"current",is_primary:!1});a.useEffect(()=>{A()},[]);const A=async()=>{d(!0),$(null);try{const k=await(await fetch(`${N}/accounting/admin/get-bank-accounts`,{method:"GET",credentials:"include"})).json();k.success?R(k.data):$(k.message||"Failed to fetch bank accounts")}catch(l){$("Network error occurred"),console.error("Error:",l)}finally{d(!1)}},y=l=>{const{name:k,value:b,type:H,checked:t}=l.target;w(z=>({...z,[k]:H==="checkbox"?t:b}))},C=()=>{w({bank_name:"",account_number:"",account_name:"",account_type:"current",is_primary:!1})},_=async l=>{l.preventDefault(),p(!0);try{const b=await(await fetch(`${N}/accounting/admin/create-bank-account`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(u)})).json();b.success?(alert("Bank account added successfully!"),S(!1),C(),A()):alert(b.message||"Failed to add bank account")}catch(k){alert("Network error occurred"),console.error("Error:",k)}finally{p(!1)}},f=async l=>{l.preventDefault(),p(!0);try{const b=await(await fetch(`${N}/accounting/admin/update-bank-account`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...u,id:W.id})})).json();b.success?(alert("Bank account updated successfully!"),g(!1),B(null),C(),A()):alert(b.message||"Failed to update bank account")}catch(k){alert("Network error occurred"),console.error("Error:",k)}finally{p(!1)}},r=async l=>{if(confirm("Are you sure you want to delete this bank account? If it has payment history, it will be deactivated instead.")){p(!0);try{const b=await(await fetch(`${N}/accounting/admin/delete-bank-account`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:l})})).json();b.success?(alert(b.message),A()):alert(b.message||"Failed to delete bank account")}catch(k){alert("Network error occurred"),console.error("Error:",k)}finally{p(!1)}}},L=l=>{B(l),w({bank_name:l.bank_name,account_number:l.account_number,account_name:l.account_name,account_type:l.account_type,is_primary:l.is_primary}),g(!0)},v=async l=>{p(!0);try{const b=await(await fetch(`${N}/accounting/admin/update-bank-account`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:l.id,is_active:!l.is_active})})).json();b.success?A():alert(b.message||"Failed to update account status")}catch(k){alert("Network error occurred"),console.error("Error:",k)}finally{p(!1)}};return e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4 sm:mb-6 flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Bank Account Management"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Manage school bank accounts for parent payments"})]}),e.jsxs("button",{onClick:()=>S(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 flex items-center justify-center gap-2 whitespace-nowrap",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Bank Account"]})]}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:M?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):O?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600",children:O}),e.jsx("button",{onClick:A,className:"mt-4 text-primary-600 hover:text-primary-700 font-medium",children:"Try Again"})]}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M3 10h18M7 15h1m4 0h1m-7 4h12a3 3 0 003-3V8a3 3 0 00-3-3H6a3 3 0 00-3 3v8a3 3 0 003 3z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No bank accounts"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by adding your first bank account."}),e.jsx("div",{className:"mt-6",children:e.jsx("button",{onClick:()=>S(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700",children:"Add Bank Account"})})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden p-3 space-y-3",children:x.map(l=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-1",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm",children:l.bank_name}),l.is_primary&&e.jsx("span",{className:"px-2 py-0.5 text-xs font-semibold rounded-full bg-primary-100 text-primary-800",children:"Primary"})]}),e.jsx("p",{className:"text-xs text-gray-600",children:l.account_number}),e.jsx("p",{className:"text-xs text-gray-600",children:l.account_name}),e.jsx("p",{className:"text-xs text-gray-500 capitalize mt-1",children:l.account_type})]}),e.jsx("button",{onClick:()=>v(l),disabled:i,className:`px-2 py-1 text-xs font-semibold rounded-full whitespace-nowrap ml-2 ${l.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"} disabled:opacity-50`,children:l.is_active?"Active":"Inactive"})]}),e.jsx("div",{className:"flex gap-2 mt-3",children:e.jsxs("button",{onClick:()=>L(l),className:"flex-1 py-2 px-3 bg-primary-50 text-primary-600 rounded-md hover:bg-primary-100 font-medium text-sm flex items-center justify-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Edit"]})})]},l.id))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Bank Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Number"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(l=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:l.bank_name}),l.is_primary&&e.jsx("span",{className:"ml-2 px-2 py-1 text-xs font-semibold rounded-full bg-primary-100 text-primary-800",children:"Primary"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l.account_number}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:l.account_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"capitalize text-sm text-gray-600",children:l.account_type})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("button",{onClick:()=>v(l),disabled:i,className:`px-3 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${l.is_active?"bg-green-100 text-green-800 hover:bg-green-200":"bg-red-100 text-red-800 hover:bg-red-200"} disabled:opacity-50`,children:l.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:e.jsxs("div",{className:"flex gap-3",children:[e.jsx("button",{onClick:()=>L(l),className:"text-primary-600 hover:text-primary-900",title:"Edit",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),e.jsx("button",{onClick:()=>r(l.id),disabled:i,className:"text-red-600 hover:text-red-900 disabled:opacity-50",title:"Delete",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})})]},l.id))})]})})]})}),(j||V)&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:()=>{j?S(!1):g(!1),C()},children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:l=>l.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:j?"Add Bank Account":"Edit Bank Account"}),e.jsx("button",{onClick:()=>{j?S(!1):g(!1),C()},className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:j?_:f,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Bank Name"}),e.jsx("input",{type:"text",name:"bank_name",value:u.bank_name,onChange:y,required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., First Bank"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Number"}),e.jsx("input",{type:"text",name:"account_number",value:u.account_number,onChange:y,required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 1234567890"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Name"}),e.jsx("input",{type:"text",name:"account_name",value:u.account_name,onChange:y,required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., ABC School"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Account Type"}),e.jsxs("select",{name:"account_type",value:u.account_type,onChange:y,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"savings",children:"Savings"}),e.jsx("option",{value:"current",children:"Current"}),e.jsx("option",{value:"domiciliary",children:"Domiciliary"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",name:"is_primary",checked:u.is_primary,onChange:y,className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Set as primary account"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",disabled:i,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 disabled:opacity-50",children:i?"Saving...":j?"Add Account":"Update Account"}),e.jsx("button",{type:"button",onClick:()=>{j?S(!1):g(!1),C()},className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})]})})]})},ge=()=>{const[x,R]=a.useState([]),[M,d]=a.useState([]),[O,$]=a.useState([]),[j,S]=a.useState([]),[V,g]=a.useState(!0),[W,B]=a.useState(null),[i,p]=a.useState(!1),[u,w]=a.useState(!1),[A,y]=a.useState(!1),[C,_]=a.useState(!1),[f,r]=a.useState(null),[L,v]=a.useState(!1),[l,k]=a.useState("categories"),[b,H]=a.useState({show:!1,type:"",message:""}),[t,z]=a.useState(!1),[q,E]=a.useState({name:"",description:""}),[n,h]=a.useState({fee_category_id:"",apply_to:"class",class:"",student_id:"",session:"",term:"",amount:"",frequency:"per-term",is_mandatory:!0}),[Z,G]=a.useState(""),[ee,Q]=a.useState(!1),se=a.useRef(null);a.useEffect(()=>{te(),I(),ne(),ae()},[]),a.useEffect(()=>{l==="structures"&&I()},[t]),a.useEffect(()=>{const s=o=>{se.current&&!se.current.contains(o.target)&&Q(!1)};return document.addEventListener("mousedown",s),()=>{document.removeEventListener("mousedown",s)}},[]);const te=async()=>{try{const o=await(await fetch(`${N}/accounting/fee-categories`,{credentials:"include"})).json();o.success&&R(o.data)}catch(s){console.error("Error fetching categories:",s)}},I=async()=>{g(!0);try{const F=await(await fetch(`${N}/accounting/admin/get-fee-structure${t?"?only_archived=true":""}`,{credentials:"include"})).json();F.success?d(F.data):B(F.message)}catch(s){B("Network error occurred"),console.error("Error:",s)}finally{g(!1)}},ne=async()=>{try{const o=await(await fetch(`${N}/school/get-classes`,{credentials:"include"})).json();if(o.success){const F=[...new Set(o.classes.map(P=>P.class_name))].sort();$(F)}}catch(s){console.error("Error fetching classes:",s)}},ae=async()=>{try{const o=await(await fetch(`${N}/get-students-with-ids`,{credentials:"include"})).json();o.success&&S(o.data||[])}catch(s){console.error("Error fetching students:",s),S([])}},T=(s,o)=>{H({show:!0,type:s,message:o})},c=s=>{r(s),h({fee_category_id:s.fee_category_id.toString(),apply_to:s.student_id?"student":"class",class:s.class||"",student_id:s.student_id?s.student_id.toString():"",session:s.session,term:s.term||"",amount:s.amount.toString(),frequency:s.frequency,is_mandatory:s.is_mandatory}),y(!0)},m=async s=>{s.preventDefault(),v(!0);try{const o={id:f.id,fee_category_id:n.fee_category_id,session:n.session,term:n.term,amount:n.amount,frequency:n.frequency,is_mandatory:n.is_mandatory,update_linked_fees:!0};n.apply_to==="student"?o.student_id=n.student_id:o.class=n.class;const P=await(await fetch(`${N}/accounting/admin/update-fee-structure`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)})).json();if(P.success){try{const J=await(await fetch(`${N}/accounting/admin/assign-fees-to-students`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({fee_structure_id:f.id})})).json();let Y="Fee structure updated successfully!";P.data.updated_linked_fees>0&&(Y+=` ${P.data.updated_linked_fees} existing unpaid fee(s) were updated.`),J.success&&J.assigned_count>0&&(Y+=` ${J.assigned_count} new student(s) were assigned this fee.`),T("success",Y)}catch(re){console.error("Assignment error:",re);let J="Fee structure updated successfully!";P.data.updated_linked_fees>0&&(J+=` ${P.data.updated_linked_fees} unpaid student fee(s) were also updated.`),T("success",J)}y(!1),r(null),h({fee_category_id:"",apply_to:"class",class:"",student_id:"",session:"",term:"",amount:"",frequency:"per-term",is_mandatory:!0}),I()}else T("error",P.message||"Failed to update fee structure")}catch(o){T("error","Network error occurred"),console.error("Error:",o)}finally{v(!1)}},D=s=>{r(s),_(!0)},X=async(s,o=!0)=>{v(!0);try{const P=await(await fetch(`${N}/accounting/admin/archive-fee-structure`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:s.id,is_active:!o})})).json();P.success?(T("success",P.message),I()):T("error",P.message||`Failed to ${o?"archive":"unarchive"} fee structure`)}catch(F){T("error","Network error occurred"),console.error("Error:",F)}finally{v(!1)}},ce=async()=>{v(!0);try{const o=await(await fetch(`${N}/accounting/admin/delete-fee-structure`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({id:f.id})})).json();if(o.success){let F="Fee structure deleted successfully!";o.deleted_student_fees>0&&(F+=` ${o.deleted_student_fees} related student fee record(s) were also removed.`),T("success",F),_(!1),r(null),I()}else{let F=o.message||"Failed to delete fee structure";o.payments_count&&o.payments_count>0&&(F+=`. This fee has ${o.payments_count} payment(s) recorded. You cannot delete a fee structure with existing payments. Consider archiving it instead.`),T("error",F)}}catch(s){T("error","Network error occurred"),console.error("Error:",s)}finally{v(!1)}},ie=j.filter(s=>{var F,P;if(!Z)return!0;const o=Z.toLowerCase();return((F=s.name)==null?void 0:F.toLowerCase().includes(o))||((P=s.admission_no)==null?void 0:P.toLowerCase().includes(o))}),U=j.find(s=>s.id===parseInt(n.student_id)),oe=async s=>{s.preventDefault(),v(!0);try{const F=await(await fetch(`${N}/accounting/fee-categories/create`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(q)})).json();F.success?(T("success","Fee category created successfully!"),p(!1),E({name:"",description:""}),te()):T("error",F.message||"Failed to create category")}catch(o){T("error","Network error occurred"),console.error("Error:",o)}finally{v(!1)}},de=async s=>{s.preventDefault(),v(!0);try{const o={fee_category_id:n.fee_category_id,session:n.session,term:n.term,amount:n.amount,frequency:n.frequency,is_mandatory:n.is_mandatory};n.apply_to==="student"?o.student_id=n.student_id:o.class=n.class;const P=await(await fetch(`${N}/accounting/admin/create-fee-structure`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(o)})).json();if(P.success){const re=P.data.id;try{const Y=await(await fetch(`${N}/accounting/admin/assign-fees-to-students`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({fee_structure_id:re})})).json();if(Y.success){let le="Fee structure created successfully!";Y.assigned_count>0&&(le+=` Assigned to ${Y.assigned_count} student(s).`),Y.skipped_count>0&&(le+=` ${Y.skipped_count} student(s) already had this fee.`),T("success",le)}else T("success","Fee structure created but failed to auto-assign to students")}catch(J){console.error("Assignment error:",J),T("success","Fee structure created but failed to auto-assign to students")}w(!1),h({fee_category_id:"",apply_to:"class",class:"",student_id:"",session:"",term:"",amount:"",frequency:"per-term",is_mandatory:!0}),I()}else T("error",P.message||"Failed to create fee structure")}catch(o){T("error","Network error occurred"),console.error("Error:",o)}finally{v(!1)}};return e.jsxs("div",{className:"p-3 sm:p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"Fee Management"}),e.jsx("p",{className:"text-sm sm:text-base text-gray-600 mt-1",children:"Manage fee categories and structures"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow mb-6",children:e.jsx("div",{className:"border-b border-gray-200",children:e.jsxs("nav",{className:"flex -mb-px overflow-x-auto",children:[e.jsx("button",{onClick:()=>k("categories"),className:`py-3 sm:py-4 px-4 sm:px-6 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${l==="categories"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Fee Categories"}),e.jsx("button",{onClick:()=>k("structures"),className:`py-3 sm:py-4 px-4 sm:px-6 text-xs sm:text-sm font-medium border-b-2 transition-colors whitespace-nowrap ${l==="structures"?"border-primary-500 text-primary-600":"border-transparent text-gray-500 hover:text-gray-700 hover:border-gray-300"}`,children:"Fee Structures"})]})})}),l==="categories"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsxs("div",{className:"p-3 sm:p-4 border-b border-gray-200 flex flex-col sm:flex-row justify-between items-start sm:items-center gap-3",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold",children:"Fee Categories"}),e.jsxs("button",{onClick:()=>p(!0),className:"bg-primary-600 text-white px-3 sm:px-4 py-2 rounded-md hover:bg-primary-700 flex items-center gap-2 text-sm w-full sm:w-auto justify-center",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Category"]})]}),x.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:"No fee categories yet. Add one to get started."})}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"block md:hidden p-3 space-y-3",children:x.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-2",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm flex-1",children:s.name}),e.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full whitespace-nowrap ml-2 ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?"Active":"Inactive"})]}),e.jsx("p",{className:"text-xs text-gray-600 mb-2",children:s.description||"No description"}),e.jsxs("p",{className:"text-xs text-gray-500",children:["Created ",new Date(s.created_at).toLocaleDateString()]})]},s.id))}),e.jsx("div",{className:"hidden md:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Created"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:s.name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.description||"N/A"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${s.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.is_active?"Active":"Inactive"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:new Date(s.created_at).toLocaleDateString()})]},s.id))})]})})]})]}),l==="structures"&&e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"p-3 sm:p-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex flex-col sm:flex-row justify-between items-stretch sm:items-center gap-3",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row items-start sm:items-center gap-2 sm:gap-4",children:[e.jsx("h2",{className:"text-base sm:text-lg font-semibold",children:"Fee Structures"}),e.jsx("button",{onClick:()=>z(!t),className:`px-3 py-1.5 text-xs sm:text-sm rounded-md flex items-center justify-center gap-2 ${t?"bg-primary-100 text-primary-800 hover:bg-primary-200 border border-primary-300":"bg-gray-100 text-gray-700 hover:bg-gray-200"}`,children:t?e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),e.jsx("span",{className:"whitespace-nowrap",children:"View Active Fees"})]}):e.jsxs(e.Fragment,{children:[e.jsx("svg",{className:"w-3 h-3 sm:w-4 sm:h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),e.jsx("span",{className:"whitespace-nowrap",children:"View Archived"})]})})]}),e.jsxs("button",{onClick:()=>w(!0),className:"bg-primary-600 text-white px-3 sm:px-4 py-2 rounded-md hover:bg-primary-700 flex items-center justify-center gap-2 text-sm",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Fee Structure"]})]})}),V?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):M.length===0?e.jsx("div",{className:"text-center py-12",children:e.jsx("p",{className:"text-gray-500",children:t?"No archived fee structures found.":"No fee structures yet. Add one to get started."})}):e.jsxs(e.Fragment,{children:[t&&e.jsx("div",{className:"bg-primary-50 border-l-4 border-primary-400 p-3 sm:p-4 m-3 sm:m-4",children:e.jsxs("div",{className:"flex items-start sm:items-center gap-2 sm:gap-3",children:[e.jsx("svg",{className:"w-4 h-4 sm:w-5 sm:h-5 text-primary-600 flex-shrink-0 mt-0.5 sm:mt-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("p",{className:"text-xs sm:text-sm font-medium text-primary-800",children:"Viewing Archived Fee Structures"}),e.jsx("p",{className:"text-xs text-primary-700 mt-1",children:`These fees are no longer active and won't appear in student balances. Click "View Active Fees" to return to active fees.`})]})]})}),e.jsx("div",{className:"block lg:hidden p-3 space-y-3",children:M.map(s=>e.jsxs("div",{className:"border border-gray-200 rounded-lg p-3",children:[e.jsxs("div",{className:"flex items-start justify-between mb-3",children:[e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("h3",{className:"font-medium text-gray-900 text-sm mb-1",children:s.category_name}),e.jsxs("div",{className:"flex items-center gap-2 flex-wrap mb-2",children:[e.jsx("span",{className:`px-2 py-0.5 text-xs font-semibold rounded-full ${s.is_mandatory?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.is_mandatory?"Mandatory":"Optional"}),e.jsx("span",{className:"text-xs text-gray-600 capitalize",children:s.frequency})]})]}),e.jsx("div",{className:"text-right ml-2",children:e.jsxs("p",{className:"font-semibold text-gray-900 text-sm whitespace-nowrap",children:["₦",s.amount.toLocaleString()]})})]}),e.jsxs("div",{className:"space-y-1.5 text-xs mb-3",children:[e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx("span",{className:"font-medium min-w-[80px]",children:"Applied To:"}),s.student_id?e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsx("div",{className:"font-medium text-gray-900 truncate",children:s.student_name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.admission_number})]}):s.class?e.jsx("span",{className:"text-gray-900",children:s.class}):e.jsx("span",{className:"text-gray-500",children:"All Students"})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx("span",{className:"font-medium min-w-[80px]",children:"Session:"}),e.jsx("span",{className:"text-gray-900",children:s.session})]}),e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx("span",{className:"font-medium min-w-[80px]",children:"Term:"}),e.jsx("span",{className:"text-gray-900",children:s.term||"All Terms"})]})]}),e.jsxs("div",{className:"flex items-center justify-end gap-2 pt-2 border-t border-gray-200",children:[e.jsx("button",{onClick:()=>c(s),className:"text-primary-600 hover:text-primary-900 p-1.5",title:"Edit fee structure",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),t?e.jsx("button",{onClick:()=>X(s,!1),className:"text-green-600 hover:text-green-900 p-1.5",title:"Unarchive fee structure",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}):e.jsx("button",{onClick:()=>X(s,!0),className:"text-yellow-600 hover:text-yellow-900 p-1.5",title:"Archive fee structure",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}),e.jsx("button",{onClick:()=>D(s),className:"text-red-600 hover:text-red-900 p-1.5",title:"Delete fee structure",children:e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},s.id))}),e.jsx("div",{className:"hidden lg:block overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Applied To"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Term"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Frequency"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Type"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap font-medium text-gray-900",children:s.category_name}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-600",children:s.student_id?e.jsxs("div",{children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.student_name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.admission_number})]}):s.class?e.jsx("span",{children:s.class}):e.jsx("span",{className:"text-gray-400",children:"All Students"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:s.session}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:s.term||"All Terms"}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap font-semibold text-gray-900",children:["₦",s.amount.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"capitalize text-sm text-gray-600",children:s.frequency})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 text-xs font-semibold rounded-full ${s.is_mandatory?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-800"}`,children:s.is_mandatory?"Mandatory":"Optional"})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-right text-sm font-medium",children:[e.jsx("button",{onClick:()=>c(s),className:"text-primary-600 hover:text-primary-900 mr-3",title:"Edit fee structure",children:e.jsx("svg",{className:"w-5 h-5 inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})})}),t?e.jsx("button",{onClick:()=>X(s,!1),className:"text-green-600 hover:text-green-900 mr-3",title:"Unarchive fee structure",children:e.jsx("svg",{className:"w-5 h-5 inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}):e.jsx("button",{onClick:()=>X(s,!0),className:"text-yellow-600 hover:text-yellow-900 mr-3",title:"Archive fee structure",children:e.jsx("svg",{className:"w-5 h-5 inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 8h14M5 8a2 2 0 110-4h14a2 2 0 110 4M5 8v10a2 2 0 002 2h10a2 2 0 002-2V8m-9 4h4"})})}),e.jsx("button",{onClick:()=>D(s),className:"text-red-600 hover:text-red-900",title:"Delete fee structure",children:e.jsx("svg",{className:"w-5 h-5 inline",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})})})]})]},s.id))})]})})]})]}),i&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:()=>p(!1),children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Fee Category"}),e.jsx("button",{onClick:()=>p(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:oe,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category Name"}),e.jsx("input",{type:"text",value:q.name,onChange:s=>E({...q,name:s.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., Tuition Fee"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description"}),e.jsx("textarea",{value:q.description,onChange:s=>E({...q,description:s.target.value}),rows:3,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Optional description"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",disabled:L,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 disabled:opacity-50",children:L?"Creating...":"Create Category"}),e.jsx("button",{type:"button",onClick:()=>p(!1),className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})]})}),u&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:()=>w(!1),children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-[500px] shadow-lg rounded-md bg-white",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Add Fee Structure"}),e.jsx("button",{onClick:()=>w(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:de,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Category"}),e.jsxs("select",{value:n.fee_category_id,onChange:s=>h({...n,fee_category_id:s.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select category"}),x.filter(s=>s.is_active).map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apply Fee To"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"class",checked:n.apply_to==="class",onChange:s=>h({...n,apply_to:s.target.value,student_id:""}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Class/All Students"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"student",checked:n.apply_to==="student",onChange:s=>h({...n,apply_to:s.target.value,class:""}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Individual Student"})]})]})]}),n.apply_to==="class"?e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),e.jsxs("select",{value:n.class,onChange:s=>h({...n,class:s.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"All Classes"}),O.map((s,o)=>e.jsx("option",{value:s,children:s},o))]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:'Select specific class or leave as "All Classes"'})]}):e.jsxs("div",{className:"relative",ref:se,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Student"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:U?`${U.name} (${U.admission_no})`:Z,onChange:s=>{G(s.target.value),Q(!0),s.target.value||h({...n,student_id:""})},onFocus:()=>{U||Q(!0)},readOnly:!!U,placeholder:"Search by name or admission number...",required:!n.student_id,className:`w-full border border-gray-300 rounded-md p-2 pr-8 focus:ring-primary-500 focus:border-primary-500 ${U?"bg-gray-50 cursor-default":""}`}),e.jsx("svg",{className:"absolute right-2 top-3 w-5 h-5 text-gray-400 pointer-events-none",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M21 21l-6-6m2-5a7 7 0 11-14 0 7 7 0 0114 0z"})})]}),e.jsx("input",{type:"hidden",value:n.student_id}),ee&&!U&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-y-auto",children:ie&&ie.length>0?ie.map(s=>e.jsxs("div",{onMouseDown:o=>{o.preventDefault(),h({...n,student_id:s.id.toString()}),G(""),Q(!1)},className:"px-4 py-2 hover:bg-primary-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:[s.admission_no," - ",s.class||"N/A"]})]},s.id)):e.jsx("div",{className:"px-4 py-3 text-sm text-gray-500 text-center",children:"No students found"})}),U&&!ee&&e.jsx("div",{className:"mt-2 p-2 bg-primary-50 rounded border border-primary-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:U.name}),e.jsxs("div",{className:"text-xs text-gray-600",children:[U.admission_no," - ",U.class||"N/A"]})]}),e.jsx("button",{type:"button",onClick:()=>{h({...n,student_id:""}),G("")},className:"text-red-600 hover:text-red-800",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (₦)"}),e.jsx("input",{type:"number",step:"0.01",value:n.amount,onChange:s=>h({...n,amount:s.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0.00"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session"}),e.jsx("input",{type:"text",value:n.session,onChange:s=>h({...n,session:s.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 2023/2024"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Term"}),e.jsxs("select",{value:n.term,onChange:s=>h({...n,term:s.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"All Terms"}),e.jsx("option",{value:"First Term",children:"First Term"}),e.jsx("option",{value:"Second Term",children:"Second Term"}),e.jsx("option",{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency"}),e.jsxs("select",{value:n.frequency,onChange:s=>h({...n,frequency:s.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"one-time",children:"One-time"}),e.jsx("option",{value:"per-term",children:"Per Term"}),e.jsx("option",{value:"per-session",children:"Per Session"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",checked:n.is_mandatory,onChange:s=>h({...n,is_mandatory:s.target.checked}),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{className:"ml-2 block text-sm text-gray-900",children:"Mandatory fee (required for all students)"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",disabled:L,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 disabled:opacity-50",children:L?"Creating...":"Create Fee Structure"}),e.jsx("button",{type:"button",onClick:()=>w(!1),className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})]})}),A&&f&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:()=>y(!1),children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-[500px] shadow-lg rounded-md bg-white max-h-[90vh] overflow-y-auto",onClick:s=>s.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Edit Fee Structure"}),e.jsx("button",{onClick:()=>y(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:m,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Fee Category"}),e.jsxs("select",{value:n.fee_category_id,onChange:s=>h({...n,fee_category_id:s.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"Select category"}),x.filter(s=>s.is_active).map(s=>e.jsx("option",{value:s.id,children:s.name},s.id))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Apply Fee To"}),e.jsxs("div",{className:"flex gap-4",children:[e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"class",checked:n.apply_to==="class",onChange:s=>h({...n,apply_to:s.target.value,student_id:""}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Class/All Students"})]}),e.jsxs("label",{className:"flex items-center",children:[e.jsx("input",{type:"radio",value:"student",checked:n.apply_to==="student",onChange:s=>h({...n,apply_to:s.target.value,class:""}),className:"mr-2"}),e.jsx("span",{className:"text-sm text-gray-700",children:"Individual Student"})]})]})]}),n.apply_to==="student"&&f.student_name&&e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Note:"})," Changing the student will affect existing fee records."]})}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (₦)"}),e.jsx("input",{type:"number",step:"0.01",value:n.amount,onChange:s=>h({...n,amount:s.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0.00"}),e.jsx("p",{className:"text-xs text-yellow-600 mt-1",children:"Unpaid fees will be updated automatically."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session"}),e.jsx("input",{type:"text",value:n.session,onChange:s=>h({...n,session:s.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"e.g., 2023/2024"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Term"}),e.jsxs("select",{value:n.term,onChange:s=>h({...n,term:s.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"",children:"All Terms"}),e.jsx("option",{value:"First Term",children:"First Term"}),e.jsx("option",{value:"Second Term",children:"Second Term"}),e.jsx("option",{value:"Third Term",children:"Third Term"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Frequency"}),e.jsxs("select",{value:n.frequency,onChange:s=>h({...n,frequency:s.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"one-time",children:"One-time"}),e.jsx("option",{value:"per-term",children:"Per Term"}),e.jsx("option",{value:"per-session",children:"Per Session"}),e.jsx("option",{value:"monthly",children:"Monthly"})]})]}),e.jsxs("div",{className:"flex items-center",children:[e.jsx("input",{type:"checkbox",id:"edit-is-mandatory",checked:n.is_mandatory,onChange:s=>h({...n,is_mandatory:s.target.checked}),className:"h-4 w-4 text-primary-600 focus:ring-primary-500 border-gray-300 rounded"}),e.jsx("label",{htmlFor:"edit-is-mandatory",className:"ml-2 text-sm text-gray-700",children:"This is a mandatory fee"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",disabled:L,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 disabled:opacity-50",children:L?"Updating...":"Update Fee Structure"}),e.jsx("button",{type:"button",onClick:()=>y(!1),className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})]})}),C&&f&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",onClick:()=>_(!1),children:e.jsx("div",{className:"relative mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("div",{className:"mx-auto flex items-center justify-center h-12 w-12 rounded-full bg-red-100",children:e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsx("h3",{className:"text-lg leading-6 font-medium text-gray-900 mt-4",children:"Delete Fee Structure?"}),e.jsxs("div",{className:"mt-2 px-7 py-3",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Are you sure you want to delete the ",e.jsx("strong",{children:f.category_name})," fee structure for"," ",f.student_name||f.class||"all students","?"]}),e.jsx("p",{className:"text-sm text-red-600 mt-2",children:"This action cannot be undone. All unpaid student fees linked to this structure will also be deleted."})]}),e.jsxs("div",{className:"items-center px-4 py-3 gap-3 flex",children:[e.jsx("button",{onClick:()=>_(!1),disabled:L,className:"flex-1 px-4 py-2 bg-gray-200 text-gray-700 text-base font-medium rounded-md hover:bg-gray-300 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:ce,disabled:L,className:"flex-1 px-4 py-2 bg-red-600 text-white text-base font-medium rounded-md hover:bg-red-700 disabled:opacity-50",children:L?"Deleting...":"Delete"})]})]})})}),b.show&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50 flex items-center justify-center",onClick:()=>H({show:!1,type:"",message:""}),children:e.jsx("div",{className:"relative mx-auto p-5 border w-96 shadow-lg rounded-md bg-white",onClick:s=>s.stopPropagation(),children:e.jsxs("div",{className:"mt-3 text-center",children:[e.jsx("div",{className:`mx-auto flex items-center justify-center h-12 w-12 rounded-full ${b.type==="success"?"bg-green-100":"bg-red-100"}`,children:b.type==="success"?e.jsx("svg",{className:"h-6 w-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}):e.jsx("svg",{className:"h-6 w-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})}),e.jsx("h3",{className:`text-lg leading-6 font-medium mt-4 ${b.type==="success"?"text-green-900":"text-red-900"}`,children:b.type==="success"?"Success!":"Error"}),e.jsx("div",{className:"mt-2 px-7 py-3",children:e.jsx("p",{className:"text-sm text-gray-600",children:b.message})}),e.jsx("div",{className:"items-center px-4 py-3",children:e.jsx("button",{onClick:()=>H({show:!1,type:"",message:""}),className:`px-4 py-2 ${b.type==="success"?"bg-green-600 hover:bg-green-700":"bg-red-600 hover:bg-red-700"} text-white text-base font-medium rounded-md w-full shadow-sm focus:outline-none focus:ring-2 focus:ring-offset-2 ${b.type==="success"?"focus:ring-green-500":"focus:ring-red-500"}`,children:"OK"})})]})})})]})},ye=()=>{var f;const[x,R]=a.useState([]),[M,d]=a.useState(null),[O,$]=a.useState(!0),[j,S]=a.useState(null),[V,g]=a.useState(!1),[W,B]=a.useState(!1),[i,p]=a.useState({start_date:"",end_date:"",category:""}),[u,w]=a.useState({category:"salaries",description:"",amount:"",expense_date:new Date().toISOString().split("T")[0],payment_method:"cash",reference_no:"",receipt_image:null,notes:""}),A=[{value:"salaries",label:"Salaries & Wages"},{value:"utilities",label:"Utilities (Water, Electricity, Internet)"},{value:"supplies",label:"Supplies & Materials"},{value:"maintenance",label:"Maintenance & Repairs"},{value:"transport",label:"Transportation"},{value:"food",label:"Food & Catering"},{value:"marketing",label:"Marketing & Advertising"},{value:"equipment",label:"Equipment & Furniture"},{value:"rent",label:"Rent & Lease"},{value:"other",label:"Other Expenses"}];a.useEffect(()=>{y()},[]);const y=async()=>{$(!0),S(null);try{let r=`${N}/accounting/admin/get-expenses?`;i.start_date&&(r+=`start_date=${i.start_date}&`),i.end_date&&(r+=`end_date=${i.end_date}&`),i.category&&(r+=`category=${i.category}`);const v=await(await fetch(r,{credentials:"include"})).json();v.success?(R(v.data.expenses),d(v.data.summary)):S(v.message)}catch(r){S("Network error occurred"),console.error("Error:",r)}finally{$(!1)}},C=async r=>{r.preventDefault(),B(!0);try{const v=await(await fetch(`${N}/accounting/admin/create-expense`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(u)})).json();v.success?(alert("Expense recorded successfully!"),g(!1),w({category:"salaries",description:"",amount:"",expense_date:new Date().toISOString().split("T")[0],payment_method:"cash",reference_no:"",receipt_image:null,notes:""}),y()):alert(v.message||"Failed to record expense")}catch(L){alert("Network error occurred"),console.error("Error:",L)}finally{B(!1)}},_=r=>{const L=A.find(v=>v.value===r);return L?L.label:r};return e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Expense Tracking"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Record and monitor school expenses"})]}),e.jsxs("button",{onClick:()=>g(!0),className:"bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4v16m8-8H4"})}),"Add Expense"]})]}),M&&e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-red-100 text-red-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Expenses"}),e.jsxs("p",{className:"text-2xl font-semibold text-gray-900",children:["₦",((f=M.total_expenses)==null?void 0:f.toLocaleString())||0]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-blue-100 text-blue-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Transactions"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:M.total_count})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"p-3 rounded-full bg-purple-100 text-purple-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 12l3-3 3 3 4-4M8 21l4-4 4 4M3 4h18M4 4h16v12a1 1 0 01-1 1H5a1 1 0 01-1-1V4z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Categories"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:Object.keys(M.by_category||{}).length})]})]})})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:i.start_date,onChange:r=>p({...i,start_date:r.target.value}),className:"w-full border border-gray-300 rounded-md p-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:i.end_date,onChange:r=>p({...i,end_date:r.target.value}),className:"w-full border border-gray-300 rounded-md p-2 text-sm"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category"}),e.jsxs("select",{value:i.category,onChange:r=>p({...i,category:r.target.value}),className:"w-full border border-gray-300 rounded-md p-2 text-sm",children:[e.jsx("option",{value:"",children:"All Categories"}),A.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:y,className:"w-full bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 text-sm",children:"Apply Filters"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:O?e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):j?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("p",{className:"text-red-600",children:j}),e.jsx("button",{onClick:y,className:"mt-4 text-primary-600 hover:text-primary-700 font-medium",children:"Try Again"})]}):x.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M17 9V7a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2m2 4h10a2 2 0 002-2v-6a2 2 0 00-2-2H9a2 2 0 00-2 2v6a2 2 0 002 2zm7-5a2 2 0 11-4 0 2 2 0 014 0z"})}),e.jsx("h3",{className:"mt-2 text-sm font-medium text-gray-900",children:"No expenses found"}),e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"Get started by recording your first expense."})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Category"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Description"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Amount"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Payment Method"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase",children:"Reference"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.map(r=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(r.expense_date).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:_(r.category)})}),e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:r.description}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap font-semibold text-red-600",children:["-₦",r.amount.toLocaleString()]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600 capitalize",children:r.payment_method}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:r.reference_no||"N/A"})]},r.id))})]})})}),V&&e.jsx("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50",onClick:()=>g(!1),children:e.jsxs("div",{className:"relative top-20 mx-auto p-5 border w-[500px] shadow-lg rounded-md bg-white",onClick:r=>r.stopPropagation(),children:[e.jsxs("div",{className:"flex justify-between items-center mb-4",children:[e.jsx("h3",{className:"text-lg font-medium text-gray-900",children:"Record Expense"}),e.jsx("button",{onClick:()=>g(!1),className:"text-gray-400 hover:text-gray-500",children:e.jsx("svg",{className:"h-6 w-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:C,children:[e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Category *"}),e.jsx("select",{value:u.category,onChange:r=>w({...u,category:r.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:A.map(r=>e.jsx("option",{value:r.value,children:r.label},r.value))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Description *"}),e.jsx("textarea",{value:u.description,onChange:r=>w({...u,description:r.target.value}),required:!0,rows:2,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Brief description of the expense"})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Amount (₦) *"}),e.jsx("input",{type:"number",step:"0.01",value:u.amount,onChange:r=>w({...u,amount:r.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"0.00"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:u.expense_date,onChange:r=>w({...u,expense_date:r.target.value}),required:!0,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Payment Method"}),e.jsxs("select",{value:u.payment_method,onChange:r=>w({...u,payment_method:r.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:"cash",children:"Cash"}),e.jsx("option",{value:"bank_transfer",children:"Bank Transfer"}),e.jsx("option",{value:"cheque",children:"Cheque"}),e.jsx("option",{value:"card",children:"Card"}),e.jsx("option",{value:"mobile_money",children:"Mobile Money"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Reference No."}),e.jsx("input",{type:"text",value:u.reference_no,onChange:r=>w({...u,reference_no:r.target.value}),className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Optional"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Notes"}),e.jsx("textarea",{value:u.notes,onChange:r=>w({...u,notes:r.target.value}),rows:2,className:"w-full border border-gray-300 rounded-md p-2 focus:ring-primary-500 focus:border-primary-500",placeholder:"Additional notes (optional)"})]})]}),e.jsxs("div",{className:"flex gap-3 mt-6",children:[e.jsx("button",{type:"submit",disabled:W,className:"flex-1 bg-primary-600 text-white px-4 py-2 rounded-md hover:bg-primary-700 disabled:opacity-50",children:W?"Recording...":"Record Expense"}),e.jsx("button",{type:"button",onClick:()=>g(!1),className:"flex-1 bg-gray-200 text-gray-700 px-4 py-2 rounded-md hover:bg-gray-300",children:"Cancel"})]})]})]})})]})},fe=()=>{const[x,R]=a.useState(null),[M,d]=a.useState(!0),[O,$]=a.useState(""),[j,S]=a.useState({start_date:new Date(new Date().getFullYear(),0,1).toISOString().split("T")[0],end_date:new Date(new Date().getFullYear(),11,31).toISOString().split("T")[0],session:`${new Date().getFullYear()}/${new Date().getFullYear()+1}`});a.useEffect(()=>{V()},[j]);const V=async()=>{try{d(!0),$("");const i=new URLSearchParams({start_date:j.start_date,end_date:j.end_date,session:j.session}),u=await(await fetch(`${N}/accounting/admin/get-financial-report?${i}`,{method:"GET",credentials:"include"})).json();u.success?R(u.data):$(u.message||"Failed to load financial report")}catch(i){console.error("Error fetching financial report:",i),$("Network error occurred")}finally{d(!1)}},g=i=>new Intl.NumberFormat("en-NG",{style:"currency",currency:"NGN"}).format(i||0),W=i=>{const[p,u]=i.split("-");return new Date(p,u-1).toLocaleDateString("en-US",{month:"short",year:"numeric"})},B=i=>({salaries:"bg-blue-100 text-blue-800",utilities:"bg-yellow-100 text-yellow-800",supplies:"bg-green-100 text-green-800",maintenance:"bg-red-100 text-red-800",transport:"bg-purple-100 text-purple-800",food:"bg-orange-100 text-orange-800",marketing:"bg-pink-100 text-pink-800",equipment:"bg-indigo-100 text-indigo-800",rent:"bg-gray-100 text-gray-800",other:"bg-cyan-100 text-cyan-800"})[i]||"bg-gray-100 text-gray-800";return M?e.jsx("div",{className:"p-6",children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})})}):e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"mb-6",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Financial Reports"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Comprehensive financial overview and analytics"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Start Date"}),e.jsx("input",{type:"date",value:j.start_date,onChange:i=>S({...j,start_date:i.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"End Date"}),e.jsx("input",{type:"date",value:j.end_date,onChange:i=>S({...j,end_date:i.target.value}),className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session"}),e.jsx("input",{type:"text",value:j.session,onChange:i=>S({...j,session:i.target.value}),placeholder:"2024/2025",className:"w-full border border-gray-300 rounded-md px-3 py-2 focus:outline-none focus:ring-2 focus:ring-primary-500"})]})]})}),O&&e.jsx("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg mb-6",children:O}),x&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Income"}),e.jsx("p",{className:"text-2xl font-bold text-green-600 mt-1",children:g(x.summary.total_income)})]}),e.jsx("div",{className:"bg-green-100 p-3 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8c-1.657 0-3 .895-3 2s1.343 2 3 2 3 .895 3 2-1.343 2-3 2m0-8c1.11 0 2.08.402 2.599 1M12 8V7m0 1v8m0 0v1m0-1c-1.11 0-2.08-.402-2.599-1M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Total Expenses"}),e.jsx("p",{className:"text-2xl font-bold text-red-600 mt-1",children:g(x.summary.total_expenses)})]}),e.jsx("div",{className:"bg-red-100 p-3 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M16 11V7a4 4 0 00-8 0v4M5 9h14l1 12H4L5 9z"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Net Income"}),e.jsx("p",{className:`text-2xl font-bold mt-1 ${x.summary.net_income>=0?"text-green-600":"text-red-600"}`,children:g(x.summary.net_income)})]}),e.jsx("div",{className:`p-3 rounded-full ${x.summary.net_income>=0?"bg-green-100":"bg-red-100"}`,children:e.jsx("svg",{className:`w-6 h-6 ${x.summary.net_income>=0?"text-green-600":"text-red-600"}`,fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 19v-6a2 2 0 00-2-2H5a2 2 0 00-2 2v6a2 2 0 002 2h2a2 2 0 002-2zm0 0V9a2 2 0 012-2h2a2 2 0 012 2v10m-6 0a2 2 0 002 2h2a2 2 0 002-2m0 0V5a2 2 0 012-2h2a2 2 0 012 2v14a2 2 0 01-2 2h-2a2 2 0 01-2-2z"})})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm text-gray-600",children:"Outstanding Fees"}),e.jsx("p",{className:"text-2xl font-bold text-orange-600 mt-1",children:g(x.summary.total_outstanding)}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[x.summary.students_with_balance," students"]})]}),e.jsx("div",{className:"bg-orange-100 p-3 rounded-full",children:e.jsx("svg",{className:"w-6 h-6 text-orange-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})})})]})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Income Breakdown"}),e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Total Payments"}),e.jsx("span",{className:"font-semibold",children:x.income.total_payments})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-green-50 rounded",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Verified Amount"}),e.jsx("span",{className:"font-semibold text-green-600",children:g(x.income.verified_amount)})]}),e.jsxs("div",{className:"flex justify-between items-center p-3 bg-yellow-50 rounded",children:[e.jsx("span",{className:"text-sm text-gray-600",children:"Pending Amount"}),e.jsx("span",{className:"font-semibold text-yellow-600",children:g(x.income.pending_amount)})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Payment Methods"}),x.payment_methods.length>0?e.jsx("div",{className:"space-y-3",children:x.payment_methods.map((i,p)=>e.jsxs("div",{className:"flex justify-between items-center p-3 bg-gray-50 rounded",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm font-medium text-gray-900 capitalize",children:i.method.replace("_"," ")}),e.jsxs("span",{className:"text-xs text-gray-500 ml-2",children:["(",i.count," payments)"]})]}),e.jsx("span",{className:"font-semibold",children:g(i.total)})]},p))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No payment methods data"})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Expense Breakdown by Category"}),x.expenses.by_category.length>0?e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:x.expenses.by_category.map((i,p)=>e.jsxs("div",{className:"p-4 border border-gray-200 rounded-lg",children:[e.jsx("div",{className:"flex items-center justify-between mb-2",children:e.jsx("span",{className:`px-2 py-1 rounded text-xs font-medium capitalize ${B(i.category)}`,children:i.category})}),e.jsx("p",{className:"text-xl font-bold text-gray-900",children:g(i.total)})]},p))}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No expense data for this period"})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow p-6",children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Monthly Breakdown"}),x.monthly_breakdown.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Month"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Income"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Expenses"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Net"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:x.monthly_breakdown.map((i,p)=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:W(i.month)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-green-600 font-medium",children:g(i.income)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-right text-red-600 font-medium",children:g(i.expenses)}),e.jsx("td",{className:`px-6 py-4 whitespace-nowrap text-sm text-right font-bold ${i.net>=0?"text-green-600":"text-red-600"}`,children:g(i.net)})]},p))}),e.jsx("tfoot",{className:"bg-gray-50",children:e.jsxs("tr",{className:"font-bold",children:[e.jsx("td",{className:"px-6 py-4 text-sm text-gray-900",children:"Total"}),e.jsx("td",{className:"px-6 py-4 text-sm text-right text-green-600",children:g(x.summary.total_income)}),e.jsx("td",{className:"px-6 py-4 text-sm text-right text-red-600",children:g(x.summary.total_expenses)}),e.jsx("td",{className:`px-6 py-4 text-sm text-right ${x.summary.net_income>=0?"text-green-600":"text-red-600"}`,children:g(x.summary.net_income)})]})})]})}):e.jsx("p",{className:"text-gray-500 text-center py-4",children:"No monthly data for this period"})]})]})]})},je=()=>{var ae,T;const x=a.useRef(null),[R,M]=a.useState([]),[d,O]=a.useState(null),[$,j]=a.useState(!0),[S,V]=a.useState(!1),[g,W]=a.useState(!1),[B,i]=a.useState(!1),[p,u]=a.useState(""),[w,A]=a.useState(!1),[y,C]=a.useState(null),[_,f]=a.useState({bank_code:"",account_number:"",account_name:""}),[r,L]=a.useState({show:!1,type:"",message:""}),[v,l]=a.useState(!1),[k,b]=a.useState(!1),[H,t]=a.useState(!1),[z,q]=a.useState(!1),[E,n]=a.useState(null),h=(c,m)=>{L({show:!0,type:c,message:m}),setTimeout(()=>L({show:!1,type:"",message:""}),5e3)};a.useEffect(()=>{Z(),G()},[]),a.useEffect(()=>{const c=m=>{x.current&&!x.current.contains(m.target)&&A(!1)};return document.addEventListener("mousedown",c),()=>document.removeEventListener("mousedown",c)},[]);const Z=async()=>{try{const c=await fetch(`${N}/accounting/admin/get-banks`,{credentials:"include"});c.ok||console.error("Banks API response not OK:",c.status,c.statusText);const m=await c.json();m.success?M(m.data):(console.error("Banks API error:",m.message||"Failed to load banks"),h("error",m.message||"Failed to load banks"))}catch(c){console.error("Error fetching banks:",c),h("error","Failed to load banks: "+c.message)}},G=async()=>{try{const m=await(await fetch(`${N}/accounting/admin/get-settlement-info`,{credentials:"include"})).json();if(m.success&&(O(m.data),m.data.has_subaccount&&m.data.bank_name)){const D=R.find(X=>X.name===m.data.bank_name);D&&(C(D),u(D.name)),f({bank_code:(D==null?void 0:D.code)||"",account_number:m.data.bank_account_number||"",account_name:m.data.bank_account_name||""})}}catch(c){console.error("Error fetching settlement info:",c)}finally{j(!1)}},ee=R.filter(c=>c.name.toLowerCase().includes(p.toLowerCase())||c.code.toLowerCase().includes(p.toLowerCase())),Q=c=>{C(c),u(c.name),f(m=>({...m,bank_code:c.code,account_name:""})),A(!1)},se=async()=>{if(!_.bank_code||!_.account_number){h("error","Please select a bank and enter account number");return}if(_.account_number.length!==10){h("error","Account number must be 10 digits");return}W(!0);try{const m=await(await fetch(`${N}/accounting/admin/verify-bank-account`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({account_number:_.account_number,bank_code:_.bank_code})})).json();m.success?(f(D=>({...D,account_name:m.data.account_name})),h("success","Account verified successfully")):h("error",m.message||"Failed to verify account")}catch(c){console.error("Error verifying account:",c),h("error","Failed to verify account")}finally{W(!1)}},te=async c=>{if(c.preventDefault(),!_.account_name){h("error","Please verify your account first");return}V(!0);try{const D=await(await fetch(`${N}/accounting/admin/create-subaccount`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({..._,bank_name:(y==null?void 0:y.name)||""})})).json();D.success?(h("success",d!=null&&d.has_subaccount?"Settlement account updated successfully":"Settlement account created successfully"),await G(),i(!1),C(null),u(""),f({bank_code:"",account_number:"",account_name:""})):h("error",D.message||"Failed to save settlement account")}catch(m){console.error("Error saving settlement account:",m),h("error","Failed to save settlement account")}finally{V(!1)}},I=async()=>{b(!0);try{const m=await(await fetch(`${N}/accounting/admin/delete-subaccount`,{method:"DELETE",credentials:"include"})).json();if(m.success){const D=m.paystack_deactivated?"Settlement account removed and deactivated in Paystack":"Settlement account removed (Note: Paystack deactivation may have failed)";h("success",D),l(!1),await G(),i(!1),C(null),u(""),f({bank_code:"",account_number:"",account_name:""})}else h("error",m.message||"Failed to remove settlement account")}catch(c){console.error("Error deleting settlement account:",c),h("error","Failed to remove settlement account")}finally{b(!1)}},ne=async()=>{t(!0);try{const m=await(await fetch(`${N}/accounting/admin/verify-subaccount`,{credentials:"include"})).json();m.success?(n(m.data),q(!0),h("success","Subaccount verified successfully")):(h("error",m.message||"Failed to verify subaccount"),n({error:m.message,subaccount_code:m.subaccount_code}),q(!0))}catch(c){console.error("Error verifying subaccount:",c),h("error","Failed to verify subaccount")}finally{t(!1)}};return $?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"text-gray-600",children:"Loading..."})}):e.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[r.show&&e.jsx("div",{className:"fixed top-4 right-4 z-50 animate-fade-in",children:e.jsx("div",{className:`px-6 py-4 rounded-lg ${r.type==="success"?"bg-green-500":"bg-red-500"} text-white`,children:e.jsx("p",{className:"font-medium",children:r.message})})}),e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-8",children:[e.jsx("div",{className:"mb-6 p-4 bg-gradient-to-r from-blue-50 to-primary-50 border border-primary-200 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"flex-shrink-0",children:e.jsx("div",{className:"bg-white p-2 rounded-lg shadow-sm",children:e.jsx(me,{className:"w-24 h-auto"})})}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("h3",{className:"font-semibold text-gray-900 flex items-center gap-2",children:["Secured by Paystack",e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"currentColor",viewBox:"0 0 20 20",children:e.jsx("path",{fillRule:"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z",clipRule:"evenodd"})})]}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"All payments are processed securely through Paystack's PCI-DSS compliant infrastructure. Your financial data is encrypted and protected."})]})]})}),e.jsxs("div",{className:"flex items-center justify-between mb-8",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-3xl font-bold text-primary-600 mb-2",children:"Settlement Account Setup"}),e.jsx("p",{className:"text-gray-600",children:"Configure your bank account to receive fee payments directly"})]}),(d==null?void 0:d.has_subaccount)&&!B&&e.jsxs("button",{onClick:()=>{if(i(!0),d!=null&&d.bank_name){const c=R.find(m=>m.name===d.bank_name);c&&(C(c),u(c.name),f({bank_code:c.code,account_number:d.bank_account_number||"",account_name:d.bank_account_name||""}))}},className:"px-6 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M11 5H6a2 2 0 00-2 2v11a2 2 0 002 2h11a2 2 0 002-2v-5m-1.414-9.414a2 2 0 112.828 2.828L11.828 15H9v-2.828l8.586-8.586z"})}),"Update Account"]})]}),d!=null&&d.has_subaccount&&!B?e.jsx("div",{className:"space-y-4",children:e.jsxs("div",{className:"border border-gray-200 rounded-lg overflow-hidden",children:[e.jsx("div",{className:"bg-gray-50 px-6 py-3 border-b border-gray-200",children:e.jsx("h3",{className:"font-semibold text-gray-800",children:"Active Settlement Account"})}),e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Bank Name"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:d.bank_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Account Number"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:d.bank_account_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Account Name"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:d.bank_account_name})]})]}),e.jsxs("div",{className:"mt-6 flex items-center justify-between",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),e.jsx("span",{className:"text-sm text-gray-600",children:"Verified & Active"})]}),e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsxs("button",{onClick:ne,disabled:H,className:"text-gray-600 hover:text-gray-800 text-sm font-medium flex items-center gap-1",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),H?"Verifying...":"Verify with Paystack"]}),e.jsx("button",{onClick:()=>l(!0),className:"text-red-600 hover:text-red-700 text-sm font-medium",children:"Delete Account"}),e.jsx("button",{onClick:()=>{if(i(!0),d!=null&&d.bank_name){const c=R.find(m=>m.name===d.bank_name);c&&(C(c),u(c.name),f({bank_code:c.code,account_number:d.bank_account_number||"",account_name:d.bank_account_name||""}))}},className:"text-primary-600 hover:text-primary-700 text-sm font-medium",children:"Update Account"})]})]})]})]})}):null,(!(d!=null&&d.has_subaccount)||B)&&e.jsxs(e.Fragment,{children:[(d==null?void 0:d.has_subaccount)&&B&&e.jsx("div",{className:"mb-6",children:e.jsxs("button",{onClick:()=>{i(!1),C(null),u(""),f({bank_code:"",account_number:"",account_name:""})},className:"text-gray-600 hover:text-gray-800 text-sm flex items-center gap-2",children:[e.jsx("svg",{className:"w-4 h-4",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 19l-7-7m0 0l7-7m-7 7h18"})}),"Back to Settlement Account"]})}),e.jsxs("div",{className:"mb-8 p-5 bg-primary-50 border-l-4 border-primary-500 rounded",children:[e.jsx("h3",{className:"font-semibold text-primary-900 mb-3",children:"How it works:"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-2 list-disc list-inside",children:[e.jsx("li",{children:"Parents pay school fees through the mobile app"}),e.jsx("li",{children:"Your school receives the exact fee amount in your bank account within 1-2 business days"}),e.jsx("li",{children:"You'll receive SMS/email notifications when funds are transferred to your account"}),e.jsx("li",{children:"No Paystack account needed - just provide your bank details here"})]})]}),e.jsxs("form",{onSubmit:te,className:"space-y-6",children:[e.jsxs("div",{className:"relative",ref:x,children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Bank *"}),e.jsxs("div",{className:"relative",children:[e.jsx("input",{type:"text",value:p,onChange:c=>{u(c.target.value),A(!0)},onFocus:()=>A(!0),placeholder:"Search for your bank...",className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!y}),y&&e.jsx("div",{className:"absolute right-3 top-1/2 -translate-y-1/2",children:e.jsx("button",{type:"button",onClick:()=>{C(null),u(""),f(c=>({...c,bank_code:"",account_name:""}))},className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})})]}),w&&p&&!y&&e.jsx("div",{className:"absolute z-10 w-full mt-1 bg-white border border-primary-200 rounded-lg max-h-60 overflow-y-auto",children:ee.length>0?ee.map(c=>e.jsxs("div",{onClick:()=>Q(c),className:"px-4 py-2 hover:bg-primary-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:[e.jsx("div",{className:"font-medium text-gray-900",children:c.name}),e.jsxs("div",{className:"text-xs text-gray-500",children:["Code: ",c.code]})]},c.code)):e.jsxs("div",{className:"px-4 py-3 text-gray-500 text-sm",children:['No banks found matching "',p,'"']})}),y&&e.jsx("div",{className:"mt-2 p-3 bg-primary-50 border-l-4 border-primary-500 rounded",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-primary-900",children:y.name}),e.jsxs("div",{className:"text-xs text-primary-600",children:["Code: ",y.code]})]}),e.jsx("svg",{className:"w-5 h-5 text-primary-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})})]})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Number *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:_.account_number,onChange:c=>{const m=c.target.value.replace(/\D/g,"");m.length<=10&&f(D=>({...D,account_number:m,account_name:""}))},placeholder:"Enter 10-digit account number",className:"flex-1 px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent",required:!0}),e.jsx("button",{type:"button",onClick:se,disabled:g||!_.bank_code||_.account_number.length!==10,className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:bg-gray-300 disabled:cursor-not-allowed transition-colors",children:g?"Verifying...":"Verify"})]}),e.jsx("p",{className:"mt-1 text-xs text-gray-500",children:'Click "Verify" to confirm account details'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Name *"}),e.jsx("input",{type:"text",value:_.account_name,readOnly:!0,placeholder:"Account name will appear after verification",className:"w-full px-4 py-2 border border-gray-300 rounded-lg bg-gray-50",required:!0})]}),e.jsx("div",{className:"flex justify-end gap-3",children:e.jsx("button",{type:"submit",disabled:S||!_.account_name,className:"px-8 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 disabled:bg-gray-300 disabled:cursor-not-allowed font-medium transition-colors",children:S?"Saving...":d!=null&&d.has_subaccount?"Update Settlement Account":"Create Settlement Account"})})]})]})]}),z&&E&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-2xl w-full mx-4 max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold text-gray-900",children:"Paystack Subaccount Verification"}),e.jsx("button",{onClick:()=>q(!1),className:"text-gray-400 hover:text-gray-600",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),E.error?e.jsxs("div",{className:"p-4 bg-red-50 border-l-4 border-red-500 rounded mb-4",children:[e.jsxs("div",{className:"flex items-center gap-2 mb-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h4",{className:"font-semibold text-red-900",children:"Verification Failed"})]}),e.jsx("p",{className:"text-sm text-red-700",children:E.error}),E.subaccount_code&&e.jsxs("p",{className:"text-xs text-red-600 mt-2",children:["Subaccount Code: ",E.subaccount_code]})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"p-4 bg-green-50 border-l-4 border-green-500 rounded mb-6",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("h4",{className:"font-semibold text-green-900",children:"Subaccount Active on Paystack"})]})}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Subaccount Code"}),e.jsx("p",{className:"font-mono text-sm text-gray-900 mt-1",children:E.subaccount_code})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Business Name"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:E.business_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Account Number"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:E.account_number})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Settlement Bank"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(ae=E.database_info)==null?void 0:ae.bank_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Account Name"}),e.jsx("p",{className:"font-medium text-gray-900 mt-1",children:(T=E.database_info)==null?void 0:T.bank_account_name})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Status"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${E.active?"bg-green-500":"bg-red-500"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:E.active?"Active":"Inactive"})]})]}),e.jsxs("div",{children:[e.jsx("span",{className:"text-sm text-gray-500",children:"Verification"}),e.jsxs("div",{className:"flex items-center gap-2 mt-1",children:[e.jsx("div",{className:`w-2 h-2 rounded-full ${E.is_verified?"bg-green-500":"bg-yellow-500"}`}),e.jsx("span",{className:"text-sm font-medium text-gray-900",children:E.is_verified?"Verified":"Unverified"})]})]})]}),!E.is_verified&&e.jsx("div",{className:"mt-4 p-4 bg-yellow-50 border-l-4 border-yellow-500 rounded",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-yellow-600 mt-0.5 flex-shrink-0",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M13 16h-1v-4h-1m1-4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsxs("div",{children:[e.jsx("h5",{className:"font-semibold text-yellow-900 mb-1",children:"Unverified Subaccount"}),e.jsx("p",{className:"text-sm text-yellow-800 mb-2",children:"Your subaccount is currently unverified. Don't worry - you can still receive payments and settlements!"}),e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"What this means:"})," Unverified subaccounts can receive payments normally, but may have settlement limits. Verification is handled automatically by Paystack or may require business documents for large transaction volumes."]})]})]})})]})]}),e.jsx("div",{className:"flex justify-end mt-6",children:e.jsx("button",{onClick:()=>q(!1),className:"px-6 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200",children:"Close"})})]})}),v&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:e.jsxs("div",{className:"bg-white rounded-lg p-6 max-w-md w-full mx-4",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-4",children:[e.jsx("div",{className:"w-12 h-12 bg-red-100 rounded-full flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Settlement Account"}),e.jsx("p",{className:"text-sm text-gray-600",children:"This action cannot be undone"})]})]}),e.jsxs("div",{className:"mb-6 p-4 bg-red-50 border-l-4 border-red-500 rounded",children:[e.jsx("p",{className:"text-sm text-gray-700 mb-2",children:"Are you sure you want to remove your settlement account?"}),e.jsxs("ul",{className:"text-sm text-gray-700 space-y-1 list-disc list-inside",children:[e.jsx("li",{children:"The subaccount will be deactivated in Paystack"}),e.jsx("li",{children:"You will no longer receive automatic payments"}),e.jsx("li",{children:"You'll need to set up a new account to receive settlements"})]})]}),e.jsxs("div",{className:"flex gap-3 justify-end",children:[e.jsx("button",{onClick:()=>l(!1),disabled:k,className:"px-4 py-2 text-gray-700 bg-gray-100 rounded-lg hover:bg-gray-200 disabled:opacity-50",children:"Cancel"}),e.jsx("button",{onClick:I,disabled:k,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 disabled:opacity-50 disabled:cursor-not-allowed",children:k?"Deleting...":"Yes, Delete Account"})]})]})})]})},ve=()=>e.jsx("div",{className:"min-h-screen bg-gray-50",children:e.jsxs(xe,{children:[e.jsx(K,{index:!0,element:e.jsx(ue,{to:"payment-verification",replace:!0})}),e.jsx(K,{path:"payment-verification",element:e.jsx(he,{})}),e.jsx(K,{path:"bank-accounts",element:e.jsx(pe,{})}),e.jsx(K,{path:"fee-management",element:e.jsx(ge,{})}),e.jsx(K,{path:"settlement-setup",element:e.jsx(je,{})}),e.jsx(K,{path:"expense-tracking",element:e.jsx(ye,{})}),e.jsx(K,{path:"financial-reports",element:e.jsx(fe,{})})]})});export{ve as default};
