import{r as d,u as l,w as m,j as o}from"./index.UZcXu8dh.js";import{S as h}from"./StudentForm.Bnn39uoG.js";import{d as f,e as v}from"./api.CIjYu6Aj.js";function E({school:a}){const[i,n]=d.useState(!1),c=l(),{toast:r}=m(),p=async e=>{n(!0);try{const s={...e,school_id:a.id},t=await f(s);if(t.success){if(e.parentEmail&&e.parentName&&t.student_id)try{await v({student_id:t.student_id,parent_email:e.parentEmail,parent_name:e.parentName,parent_phone:e.parentPhone||"",relationship:e.parentRelationship||"guardian",is_primary:!0}),r.success("Report card saved and parent account linked successfully!")}catch(u){console.error("Error linking parent:",u),r.success("Report card saved, but there was an issue linking the parent account.")}else r.success("Report card saved successfully!");c(`/dashboard/reports/${t.student_id}`)}else r.error("Error saving report card: "+t.message)}catch(s){console.error("Error:",s),r.error("Failed to save report card. Please try again.")}finally{n(!1)}};return o.jsx("div",{children:o.jsx(h,{onSubmit:p,saving:i,school:a})})}export{E as default};
