import{r as o,j as e}from"./index.UZcXu8dh.js";import{i as me,j as be,k as pe,l as he}from"./api.CIjYu6Aj.js";const ue=[{name:"AGRICULTURAL SCIENCE",category:"cognitive"},{name:"BIOLOGY",category:"cognitive"},{name:"CATERING CRAFTS",category:"cognitive"},{name:"CHEMISTRY",category:"cognitive"},{name:"CIVIC EDUCATION",category:"cognitive"},{name:"COMPUTER",category:"cognitive"},{name:"DATA PROCESSING",category:"cognitive"},{name:"ECONOMICS",category:"cognitive"},{name:"ELECTRICAL INSTALLATION & M",category:"cognitive"},{name:"ENGLISH LANGUAGE",category:"cognitive"},{name:"FINANCIAL ACCOUNTING",category:"cognitive"},{name:"FOOD NUTRITION",category:"cognitive"},{name:"FURTHER MATHEMATICS",category:"cognitive"},{name:"GEOGRAPHY",category:"cognitive"},{name:"GOVERNMENT",category:"cognitive"},{name:"INSURANCE",category:"cognitive"},{name:"LITERATURE IN ENGLISH",category:"cognitive"},{name:"MATHEMATICS",category:"cognitive"},{name:"OFFICE PRACTICE",category:"cognitive"},{name:"PHYSICAL EDU. ENGLISH",category:"cognitive"},{name:"PHYSICS",category:"cognitive"},{name:"TECHNICAL DRAWING",category:"cognitive"},{name:"YORUBA LANGUAGE",category:"cognitive"}],ge=["Punctuality","Attendance","Politeness","Neatness","Honesty","Relationship With Teachers","Relationship With Pupils","Self Control/ Calmness","Attentiveness","Perseverance","Sense of Responsibility"],fe=["Handwriting","Drawing/ Painting","Verbal Fluency","Games/ Sports","Handling of Tools"];function ke({onSubmit:l,saving:C=!1,school:x,initialData:b=null}){const[p,N]=o.useState(1),[h,j]=o.useState([]),[v,d]=o.useState(""),[m,a]=o.useState(!1),[A,y]=o.useState(!1),k=o.useRef(null),[V,R]=o.useState(""),[P,I]=o.useState([]),[W,E]=o.useState(!1),[U,H]=o.useState(!1),_=o.useRef(null),F=o.useRef(null),[K,B]=o.useState([]),[z,Q]=o.useState(""),[T,X]=o.useState(!1),[O,J]=o.useState([]),[G,q]=o.useState(40),[Y,Z]=o.useState(60),[n,g]=o.useState({name:"",class:"",session:"",admissionNo:"",term:"",gender:"",height:"",weight:"",clubSociety:"",favCol:"",photo:null,parentName:"",parentEmail:"",parentPhone:"",parentRelationship:"guardian",noOfTimesSchoolOpened:"",noOfTimesPresent:"",noOfTimesAbsent:"",subjects:[],affectiveDomain:{},psychomotorDomain:{},teacherName:"",teacherRemark:"",principalName:"",principalRemark:"",nextTermBegins:""});o.useEffect(()=>{b&&(g(b),R(b.admissionNo||""),b.subjects&&b.subjects.length>0&&j(b.subjects.map(r=>r.name)))},[b]),o.useEffect(()=>{(async()=>{try{const s=await pe();if(s.success){const c=[...new Set((s.classes||[]).map(i=>i.session))];B(c)}const t=await he();t.success&&(t.data.current_session&&(Q(t.data.current_session),B(c=>c.includes(t.data.current_session)?c:[t.data.current_session,...c]),b||g(c=>({...c,session:t.data.current_session}))),t.data.use_ca_breakdown&&(X(!0),J(t.data.ca_components||[])),t.data.ca_max_marks&&q(t.data.ca_max_marks),t.data.exam_max_marks&&Z(t.data.exam_max_marks))}catch(s){console.error("Error loading sessions:",s)}})()},[b]),o.useEffect(()=>{const r=s=>{F.current&&!F.current.contains(s.target)&&E(!1)};return document.addEventListener("mousedown",r),()=>{document.removeEventListener("mousedown",r)}},[]);const ee=o.useCallback(async r=>{if(r.length<2){I([]),E(!1);return}H(!0);try{const s=await me(r);s.success&&(I(s.students),E(s.students.length>0))}catch(s){console.error("Error searching students:",s),I([])}finally{H(!1)}},[]),M=o.useCallback(async r=>{if(r.length<3){a(!1);return}y(!0);try{const s=await be(r);if(s.success&&s.exists){if(a(!0),!b){const t=s.student.subjects||[],c=t.map(i=>({name:i.name,classScore:"",examScore:"",total:"",grade:"",remark:""}));g(i=>({...i,name:s.student.name||"",class:s.student.class||"",gender:s.student.gender||"",height:s.student.height||"",weight:s.student.weight||"",clubSociety:s.student.clubSociety||"",favCol:s.student.favCol||"",photo:s.student.photo||null,subjects:c,parentName:s.student.parent_name||"",parentEmail:s.student.parent_email||"",parentPhone:s.student.parent_phone||"",parentRelationship:s.student.parent_relationship||"guardian"})),t.length>0&&j(t.map(i=>i.name))}}else a(!1)}catch(s){console.error("Error checking student:",s),a(!1)}finally{y(!1)}},[b]),re=o.useCallback(r=>{g(s=>({...s,admissionNo:r.admission_no,name:r.name||"",class:r.class||"",gender:r.gender||"",height:r.height||"",weight:r.weight||"",clubSociety:r.club_society||"",favCol:r.fav_col||"",photo:r.photo||null,parentName:r.parent_name||"",parentEmail:r.parent_email||"",parentPhone:r.parent_phone||"",parentRelationship:r.parent_relationship||"guardian"})),R(r.admission_no),E(!1),a(!0),r.admission_no&&M(r.admission_no)},[M]),f=r=>{const{name:s,value:t}=r.target;g(c=>({...c,[s]:t})),s==="admissionNo"&&(k.current&&clearTimeout(k.current),k.current=setTimeout(()=>{M(t)},500))},L=(r,s,t)=>{g(c=>{const i=[...c.subjects||[]],w=i.findIndex(S=>S.name===r);let u;if(w>=0?u={...i[w],[s]:t}:u={name:r,[s]:t},T){let S=0;O.forEach((ye,ie)=>{const xe=`ca_component_${ie}`;S+=parseFloat(u[xe]||0)});const D=parseFloat(u.exam||0);u.ca=S.toString(),u.total=(S+D).toString()}else{const S=parseFloat(u.ca||0),D=parseFloat(u.exam||0);u.total=(S+D).toString()}return w>=0?i[w]=u:i.push(u),{...c,subjects:i}})},se=(r,s)=>{g(t=>({...t,affectiveDomain:{...t.affectiveDomain,[r]:s}}))},te=(r,s)=>{g(t=>({...t,psychomotorDomain:{...t.psychomotorDomain,[r]:s}}))},ae=r=>{r&&!h.includes(r)&&j(s=>[...s,r])},le=r=>{j(s=>s.filter(t=>t!==r)),g(s=>({...s,subjects:s.subjects.filter(t=>t.name!==r)}))},$=()=>{v.trim()&&!h.includes(v.trim())&&(j(r=>[...r,v.trim()]),d(""))},ne=()=>{N(r=>Math.min(r+1,4))},oe=()=>{N(r=>Math.max(r-1,1))},ce=r=>{r.preventDefault(),p<4?ne():l(n)},de=()=>{switch(p){case 1:return"Step 1: Student Information & Attendance";case 2:return"Step 2: Subject Grades (Cognitive Domain)";case 3:return"Step 3: Affective & Psychomotor Domain";case 4:return"Step 4: Remarks";default:return""}};return e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6 p-6",children:[e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 lg:col-span-3",children:[e.jsx("h2",{className:"text-lg font-bold text-gray-800 mb-4",children:"Student Report Card Form"}),e.jsxs("div",{className:"mb-8",children:[e.jsx("div",{className:"flex items-center mb-3",children:[1,2,3,4].map(r=>e.jsxs("div",{className:"flex items-center",style:{flex:r<4?"1 1 0%":"0 0 40px"},children:[e.jsx("div",{className:`flex items-center justify-center w-10 h-10 rounded-full border-2 font-semibold flex-shrink-0 ${p>=r?"bg-primary-600 text-white border-primary-600":"bg-white text-gray-400 border-gray-300"}`,children:r}),r<4&&e.jsx("div",{className:`flex-1 h-1 mx-4 ${p>r?"bg-primary-600":"bg-gray-300"}`})]},r))}),e.jsx("div",{className:"flex items-start",children:[{step:1,label:"Info & Attendance"},{step:2,label:"Subjects"},{step:3,label:"Domains"},{step:4,label:"Remarks"}].map(r=>e.jsx("div",{className:"flex justify-start",style:{flex:r.step<4?"1 1 0%":"0 0 40px"},children:e.jsx("span",{className:`text-[10px] leading-tight whitespace-nowrap ${p===r.step?"font-semibold text-primary-600":"text-gray-600"}`,children:r.label})},r.step))})]}),e.jsx("h3",{className:"text-lg font-semibold text-primary-600 mb-4",children:de()}),e.jsxs("form",{onSubmit:ce,className:"space-y-8",children:[p===1&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"border-b pb-6",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-3",children:"Student Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Full Name"}),e.jsx("input",{type:"text",name:"name",value:n.name,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Class"}),e.jsx("input",{type:"text",name:"class",value:n.class,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Session"}),e.jsxs("select",{name:"session",value:n.session,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs",children:[e.jsx("option",{value:"",children:"Select session"}),K.map((r,s)=>e.jsxs("option",{value:r,children:[r,r===z?" (Current)":""]},s))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Admission No."}),e.jsxs("div",{className:"relative",ref:F,children:[e.jsx("input",{type:"text",name:"admissionNo",value:V,onChange:r=>{const s=r.target.value;R(s),g(t=>({...t,admissionNo:s})),_.current&&clearTimeout(_.current),_.current=setTimeout(()=>{ee(s)},300)},onFocus:()=>{P.length>0&&E(!0)},placeholder:"Search by name or admission number...",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"}),U&&e.jsx("div",{className:"absolute right-3 top-2.5 text-xs text-gray-500",children:"Searching..."}),!U&&m&&n.admissionNo.length>=3&&e.jsx("div",{className:"absolute right-3 top-2.5 text-xs text-green-600 font-semibold",children:"✓ Found"}),W&&P.length>0&&e.jsx("div",{className:"absolute z-50 w-full mt-1 bg-white border border-gray-300 rounded-md shadow-lg max-h-60 overflow-auto",children:P.map(r=>e.jsx("div",{onClick:()=>re(r),className:"px-3 py-2 hover:bg-primary-50 cursor-pointer border-b border-gray-100 last:border-b-0",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("div",{className:"text-xs font-semibold text-gray-900",children:r.name}),e.jsx("div",{className:"text-[10px] text-gray-600",children:r.class})]}),e.jsx("div",{className:"text-xs text-primary-600 font-medium",children:r.admission_no})]})},r.id))})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Term"}),e.jsxs("select",{name:"term",value:n.term,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs",children:[e.jsx("option",{value:"",children:"Select Term"}),e.jsx("option",{value:"First Term",children:"First Term"}),e.jsx("option",{value:"Second Term",children:"Second Term"}),e.jsx("option",{value:"Third Term",children:"Third Term"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Gender"}),e.jsx("input",{type:"text",name:"gender",value:n.gender,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{className:"md:col-span-3 border-t pt-4 mt-4",children:[e.jsx("h4",{className:"text-sm font-semibold text-gray-700 mb-3",children:"Parent/Guardian Information"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Parent/Guardian Name"}),e.jsx("input",{type:"text",name:"parentName",value:n.parentName,readOnly:!0,placeholder:"Auto-filled from student profile",className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Parent/Guardian Email"}),e.jsx("input",{type:"email",name:"parentEmail",value:n.parentEmail,readOnly:!0,placeholder:"Auto-filled from student profile",className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Phone Number"}),e.jsx("input",{type:"tel",name:"parentPhone",value:n.parentPhone,readOnly:!0,placeholder:"Auto-filled from student profile",className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Relationship"}),e.jsx("input",{type:"text",name:"parentRelationship",value:n.parentRelationship,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs capitalize"})]})]}),e.jsx("p",{className:"text-[10px] text-gray-500 mt-2",children:"Parent information is loaded from the student's profile. To update, please edit the student profile."})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Height (cm)"}),e.jsx("input",{type:"text",name:"height",value:n.height,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Weight (kg)"}),e.jsx("input",{type:"text",name:"weight",value:n.weight,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Club/Society"}),e.jsx("input",{type:"text",name:"clubSociety",value:n.clubSociety,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Fav. Col"}),e.jsx("input",{type:"text",name:"favCol",value:n.favCol,readOnly:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-gray-700 cursor-not-allowed text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Student Photo"}),e.jsx("div",{className:"w-full px-3 py-2 border border-gray-300 rounded-md bg-gray-50 text-xs text-gray-500",children:n.photo?"Photo loaded from profile":"No photo"})]})]})]}),e.jsxs("section",{className:"border-b pb-6",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-3",children:"Attendance Summary"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"No of Times School Opened"}),e.jsx("input",{type:"number",name:"noOfTimesSchoolOpened",value:n.noOfTimesSchoolOpened,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"No of Times Present"}),e.jsx("input",{type:"number",name:"noOfTimesPresent",value:n.noOfTimesPresent,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"No of Times Absent"}),e.jsx("input",{type:"number",name:"noOfTimesAbsent",value:n.noOfTimesAbsent,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]})]})]})]}),p===2&&e.jsxs("section",{className:"border-b pb-6",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-3",children:"Subject Grades (Cognitive Domain)"}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:T?"Enter individual CA components and Exam scores. Total will be calculated automatically.":`Enter CA (max ${G}) and Exam (max ${Y}). Total will be calculated automatically.`}),e.jsxs("div",{className:"mb-4 space-y-4",children:[e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Select Subjects"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:ue.map(r=>e.jsxs("button",{type:"button",onClick:()=>ae(r.name),disabled:h.includes(r.name),className:`px-3 py-1 text-xs rounded-md border transition-colors ${h.includes(r.name)?"bg-green-100 border-green-400 text-green-700 cursor-not-allowed":"bg-white border-gray-300 text-gray-700 hover:bg-primary-50 hover:border-primary-400"}`,children:[h.includes(r.name)?"✓ ":"+ ",r.name]},r.name))})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-xs font-semibold text-gray-700 mb-2",children:"Add Custom Subject"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:v,onChange:r=>d(r.target.value),onKeyPress:r=>r.key==="Enter"&&(r.preventDefault(),$()),placeholder:"Enter subject name",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"}),e.jsx("button",{type:"button",onClick:$,className:"px-4 py-2 bg-primary-600 text-white rounded-md hover:bg-primary-700 transition-colors text-xs",children:"Add Subject"})]})]}),h.length>0&&e.jsxs("div",{className:"text-xs text-gray-600",children:[e.jsx("strong",{children:h.length})," subject(s) selected"]})]}),h.length>0?e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full border border-gray-300",children:[e.jsx("thead",{className:"bg-gray-100",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-4 py-2 text-left text-xs font-semibold text-gray-700 border-r",children:"Subject"}),T?e.jsxs(e.Fragment,{children:[O.map((r,s)=>e.jsxs("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-700 border-r",children:[r.name," (",r.max_marks,")"]},s)),e.jsxs("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-700 border-r bg-blue-50",children:["Total CA (",G,")"]})]}):e.jsxs("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-700 border-r",children:["CA (",G,")"]}),e.jsxs("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-700 border-r",children:["Exam (",Y,")"]}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-700 border-r",children:"Total (100)"}),e.jsx("th",{className:"px-4 py-2 text-center text-xs font-semibold text-gray-700",children:"Action"})]})}),e.jsx("tbody",{children:h.map(r=>{const s=n.subjects.find(c=>c.name===r);let t=0;return T&&O.forEach((c,i)=>{t+=parseFloat((s==null?void 0:s[`ca_component_${i}`])||0)}),e.jsxs("tr",{className:"border-b hover:bg-gray-50",children:[e.jsx("td",{className:"px-4 py-2 text-xs text-gray-700 border-r font-medium",children:r}),T?e.jsxs(e.Fragment,{children:[O.map((c,i)=>e.jsx("td",{className:"px-4 py-2 border-r",children:e.jsx("input",{type:"number",min:"0",step:"0.5",placeholder:c.name,value:(s==null?void 0:s[`ca_component_${i}`])||"",onChange:w=>L(r,`ca_component_${i}`,w.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})},i)),e.jsx("td",{className:"px-4 py-2 border-r bg-blue-50",children:e.jsx("input",{type:"text",value:t.toFixed(2),readOnly:!0,className:"w-full px-2 py-1 bg-blue-100 border border-blue-300 rounded text-center font-semibold text-xs"})})]}):e.jsx("td",{className:"px-4 py-2 border-r",children:e.jsx("input",{type:"number",min:"0",step:"0.5",placeholder:"CA",value:(s==null?void 0:s.ca)||"",onChange:c=>L(r,"ca",c.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})}),e.jsx("td",{className:"px-4 py-2 border-r",children:e.jsx("input",{type:"number",min:"0",step:"0.5",placeholder:"Exam",value:(s==null?void 0:s.exam)||"",onChange:c=>L(r,"exam",c.target.value),className:"w-full px-2 py-1 border border-gray-300 rounded text-center focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})}),e.jsx("td",{className:"px-4 py-2 border-r",children:e.jsx("input",{type:"number",min:"0",max:"100",placeholder:"Total",value:(s==null?void 0:s.total)||"",readOnly:!0,className:"w-full px-2 py-1 border border-gray-300 rounded text-center bg-gray-100 font-semibold text-primary-600 cursor-not-allowed text-xs"})}),e.jsx("td",{className:"px-4 py-2 text-center",children:e.jsx("button",{type:"button",onClick:()=>le(r),className:"px-3 py-1 bg-red-500 text-white text-xs rounded hover:bg-red-600 transition-colors",children:"Remove"})})]},r)})})]})}):e.jsx("div",{className:"text-center py-8 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:e.jsx("p",{className:"text-gray-500",children:"No subjects selected. Please select subjects from above."})})]}),p===3&&e.jsxs(e.Fragment,{children:[e.jsxs("section",{className:"border-b pb-6",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-3",children:"Affective Domain"}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Rate each trait on a scale of 1-5 (1 = Poor, 5 = Excellent). Leave blank if not applicable."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:ge.map(r=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:r}),e.jsxs("select",{onChange:s=>se(r,s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs",children:[e.jsx("option",{value:"",children:"Select Rating"}),e.jsx("option",{value:"1",children:"1 - Poor"}),e.jsx("option",{value:"2",children:"2 - Fair"}),e.jsx("option",{value:"3",children:"3 - Good"}),e.jsx("option",{value:"4",children:"4 - Very Good"}),e.jsx("option",{value:"5",children:"5 - Excellent"})]})]},r))})]}),e.jsxs("section",{className:"border-b pb-6",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-3",children:"Psychomotor Domain"}),e.jsx("p",{className:"text-xs text-gray-600 mb-3",children:"Rate each skill on a scale of 1-5 (1 = Poor, 5 = Excellent). Leave blank if not applicable."}),e.jsx("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:fe.map(r=>e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:r}),e.jsxs("select",{onChange:s=>te(r,s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs",children:[e.jsx("option",{value:"",children:"Select Rating"}),e.jsx("option",{value:"1",children:"1 - Poor"}),e.jsx("option",{value:"2",children:"2 - Fair"}),e.jsx("option",{value:"3",children:"3 - Good"}),e.jsx("option",{value:"4",children:"4 - Very Good"}),e.jsx("option",{value:"5",children:"5 - Excellent"})]})]},r))})]})]}),p===4&&e.jsxs("section",{className:"border-b pb-6",children:[e.jsx("h3",{className:"text-base font-semibold text-gray-700 mb-3",children:"Remarks"}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Teacher's Name"}),e.jsx("input",{type:"text",name:"teacherName",value:n.teacherName,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Teacher's Remark"}),e.jsx("textarea",{name:"teacherRemark",value:n.teacherRemark,onChange:f,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Principal's Name"}),e.jsx("input",{type:"text",name:"principalName",value:n.principalName,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Principal's Remark"}),e.jsx("textarea",{name:"principalRemark",value:n.principalRemark,onChange:f,rows:"3",className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-xs font-medium text-gray-700 mb-1",children:"Next Term Begins"}),e.jsx("input",{type:"date",name:"nextTermBegins",value:n.nextTermBegins,onChange:f,className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-primary-500 text-xs"})]})]})]}),e.jsxs("div",{className:"flex justify-between pt-6",children:[p>1&&e.jsx("button",{type:"button",onClick:oe,className:"px-6 py-3 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors duration-200 font-semibold shadow-md text-sm",children:"← Previous"}),e.jsx("div",{className:p===1?"ml-auto":"",children:e.jsx("button",{type:"submit",disabled:C,className:"px-8 py-3 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors duration-200 font-semibold shadow-md hover:shadow-lg disabled:bg-gray-400 disabled:cursor-not-allowed text-sm",children:C?"Saving...":p<4?"Next →":"Generate Report Card"})})]})]})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow-lg p-6 sticky top-6 h-fit max-h-screen overflow-y-auto overflow-x-hidden lg:col-span-2",children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-800 mb-4",children:"Live Preview"}),e.jsx("div",{className:"transform scale-[0.6] origin-top-left w-[167%]",children:e.jsx(je,{data:n,activeSubjects:h,school:x})})]})]})}function je({data:l,activeSubjects:C,school:x}){var h,j,v;const b=d=>{const m=parseFloat(d)||0;return m>=70?{grade:"A",remark:"EXCELLENT"}:m>=60?{grade:"B",remark:"VERY GOOD"}:m>=50?{grade:"C",remark:"GOOD"}:m>=40?{grade:"D",remark:"FAIR"}:{grade:"F",remark:"FAIL"}},N=(()=>{const d=l.subjects.filter(y=>y.total);if(d.length===0)return{total:0,obtainable:0,grade:"N/A",remark:"N/A"};const m=d.reduce((y,k)=>y+parseFloat(k.total||0),0),a=d.length*100,A=m/d.length;return{total:m.toFixed(0),obtainable:a,average:A.toFixed(2),...b(A)}})();return l.subjects.filter(d=>d.total),e.jsxs("div",{className:"bg-white p-8 border-4 border-black",style:{fontFamily:"Arial, sans-serif"},children:[e.jsxs("div",{className:"flex items-start justify-between mb-4 pb-4 border-b-2 border-black",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx("div",{className:"w-16 h-16 border-2 border-black rounded-full flex items-center justify-center overflow-hidden",children:x!=null&&x.logo?e.jsx("img",{src:x.logo,alt:"School Logo",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs font-bold",children:"LOGO"})}),e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold tracking-wide",children:((h=x==null?void 0:x.school_name)==null?void 0:h.toUpperCase())||"SCHOOL NAME"}),e.jsx("p",{className:"text-xs mt-1",children:(x==null?void 0:x.address)||"School Address"}),e.jsxs("p",{className:"text-xs",children:["TEL: ",(x==null?void 0:x.phone)||"N/A",", Email: ",(x==null?void 0:x.email)||"N/A"]})]})]}),e.jsx("div",{className:"w-24 h-28 border-2 border-black flex items-center justify-center bg-gray-100",children:l.photo?e.jsx("img",{src:l.photo,alt:"Student",className:"w-full h-full object-cover"}):e.jsx("span",{className:"text-xs text-gray-500",children:"PHOTO"})})]}),e.jsx("div",{className:"text-center mb-4 pb-2 border-b-2 border-black",children:e.jsxs("h2",{className:"text-sm font-bold",children:[((j=l.term)==null?void 0:j.toUpperCase())||"TERM"," STUDENT'S PERFORMANCE REPORT"]})}),e.jsxs("div",{className:"grid grid-cols-2 gap-x-8 text-xs mb-4 pb-4 border-b-2 border-black",children:[e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"NAME:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:((v=l.name)==null?void 0:v.toUpperCase())||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"CLASS:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:l.class||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"AGE:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:l.age||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"CLUB/SOCIETY:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:l.clubSociety||""})]})]}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"GENDER:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:l.gender||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"SESSION:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:l.session||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"ADMISSION NO.:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:l.admissionNo||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-24",children:"HT:"}),e.jsx("span",{className:"w-20 border-b border-black",children:l.height||""}),e.jsx("span",{className:"font-bold w-24 ml-2",children:"WT:"}),e.jsx("span",{className:"w-20 border-b border-black",children:l.weight||""})]}),e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold w-32",children:"FAV. COL:"}),e.jsx("span",{className:"flex-1 border-b border-black",children:l.favCol||""})]})]})]}),e.jsxs("div",{className:"grid grid-cols-3 gap-4",children:[e.jsxs("div",{className:"col-span-2",children:[e.jsxs("table",{className:"w-full border-2 border-black text-xs",children:[e.jsxs("thead",{children:[e.jsxs("tr",{className:"bg-gray-200",children:[e.jsx("th",{className:"border border-black p-1 text-center font-bold",rowSpan:"2",children:"COGNITIVE DOMAIN"}),e.jsx("th",{className:"border border-black p-1 text-center font-bold",colSpan:"3",children:"SCORE"}),e.jsx("th",{className:"border border-black p-1 text-center font-bold",rowSpan:"2",children:"GRADE"}),e.jsx("th",{className:"border border-black p-1 text-center font-bold",rowSpan:"2",children:"REMARKS"})]}),e.jsxs("tr",{className:"bg-gray-200",children:[e.jsxs("th",{className:"border border-black p-1 text-center text-[10px]",children:["CA",e.jsx("br",{}),"40"]}),e.jsxs("th",{className:"border border-black p-1 text-center text-[10px]",children:["EXAM",e.jsx("br",{}),"60"]}),e.jsxs("th",{className:"border border-black p-1 text-center text-[10px]",children:["TOTAL",e.jsx("br",{}),"100"]})]})]}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 font-bold bg-gray-100",children:"SUBJECTS"}),e.jsx("td",{className:"border border-black"}),e.jsx("td",{className:"border border-black"}),e.jsx("td",{className:"border border-black"}),e.jsx("td",{className:"border border-black"}),e.jsx("td",{className:"border border-black"})]}),C.length>0?C.map((d,m)=>{const a=l.subjects.find(k=>k.name===d),{grade:A,remark:y}=b(a==null?void 0:a.total);return e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 text-[10px]",children:d}),e.jsx("td",{className:"border border-black p-1 text-center",children:(a==null?void 0:a.ca)||""}),e.jsx("td",{className:"border border-black p-1 text-center",children:(a==null?void 0:a.exam)||""}),e.jsx("td",{className:"border border-black p-1 text-center font-bold",children:(a==null?void 0:a.total)||""}),e.jsx("td",{className:"border border-black p-1 text-center font-bold",children:a!=null&&a.total?A:""}),e.jsx("td",{className:"border border-black p-1 text-center text-[10px]",children:a!=null&&a.total?y:""})]},m)}):e.jsx("tr",{children:e.jsx("td",{colSpan:"6",className:"border border-black p-2 text-center text-gray-400 italic",children:"No subjects selected yet"})})]})]}),e.jsx("div",{className:"mt-4 border-2 border-black",children:e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsx("tr",{className:"bg-gray-200",children:e.jsx("th",{className:"border border-black p-1 font-bold",colSpan:"4",children:"PERFORMANCE SUMMARY"})})}),e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 font-bold",children:"Total Obtained:"}),e.jsx("td",{className:"border border-black p-1 text-center",children:N.total}),e.jsx("td",{className:"border border-black p-1 font-bold",children:"Total Obtainable:"}),e.jsx("td",{className:"border border-black p-1 text-center",children:N.obtainable})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 font-bold",colSpan:"2",children:"GRADE:"}),e.jsx("td",{className:"border border-black p-1 text-center font-bold text-lg",colSpan:"2",children:N.grade})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 font-bold",colSpan:"2",children:"REMARK:"}),e.jsx("td",{className:"border border-black p-1 text-center font-bold",colSpan:"2",children:N.remark})]})]})]})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"border-2 border-black",children:[e.jsx("div",{className:"bg-gray-200 border-b-2 border-black p-1 text-center font-bold text-xs",children:"ATTENDANCE SUMMARY"}),e.jsx("table",{className:"w-full text-xs",children:e.jsxs("tbody",{children:[e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 text-[10px]",children:"School Opened"}),e.jsx("td",{className:"border border-black p-1 text-center",children:l.noOfTimesSchoolOpened||""})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 text-[10px]",children:"Times Present"}),e.jsx("td",{className:"border border-black p-1 text-center",children:l.noOfTimesPresent||""})]}),e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 text-[10px]",children:"Times Absent"}),e.jsx("td",{className:"border border-black p-1 text-center",children:l.noOfTimesAbsent||""})]})]})})]}),Object.keys(l.affectiveDomain||{}).length>0&&e.jsxs("div",{className:"border-2 border-black",children:[e.jsx("div",{className:"bg-gray-200 border-b-2 border-black p-1 text-center font-bold text-xs",children:"AFFECTIVE DOMAIN"}),e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-black p-1 text-[10px]"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"1"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"2"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"3"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"4"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"5"})]})}),e.jsx("tbody",{children:Object.entries(l.affectiveDomain||{}).map(([d,m])=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 text-[9px]",children:d}),[1,2,3,4,5].map(a=>e.jsx("td",{className:"border border-black p-1 text-center text-[10px]",children:m==a?"✓":""},a))]},d))})]})]}),Object.keys(l.psychomotorDomain||{}).length>0&&e.jsxs("div",{className:"border-2 border-black",children:[e.jsx("div",{className:"bg-gray-200 border-b-2 border-black p-1 text-center font-bold text-xs",children:"PSYCHOMOTOR DOMAIN"}),e.jsxs("table",{className:"w-full text-xs",children:[e.jsx("thead",{children:e.jsxs("tr",{className:"bg-gray-100",children:[e.jsx("th",{className:"border border-black p-1 text-[10px]"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"1"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"2"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"3"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"4"}),e.jsx("th",{className:"border border-black p-1 text-center text-[10px]",children:"5"})]})}),e.jsx("tbody",{children:Object.entries(l.psychomotorDomain||{}).map(([d,m])=>e.jsxs("tr",{children:[e.jsx("td",{className:"border border-black p-1 text-[9px]",children:d}),[1,2,3,4,5].map(a=>e.jsx("td",{className:"border border-black p-1 text-center text-[10px]",children:m==a?"✓":""},a))]},d))})]})]})]})]}),e.jsxs("div",{className:"mt-4 space-y-2 text-xs",children:[e.jsx("div",{className:"border-2 border-black",children:e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold p-2 border-r-2 border-black w-32",children:"Teacher's Remark:"}),e.jsx("span",{className:"p-2 flex-1 italic",children:l.teacherRemark||""})]})}),e.jsx("div",{className:"border-2 border-black",children:e.jsxs("div",{className:"flex",children:[e.jsx("span",{className:"font-bold p-2 border-r-2 border-black w-32",children:"Principal's Remark:"}),e.jsx("span",{className:"p-2 flex-1 italic",children:l.principalRemark||""})]})}),e.jsx("div",{className:"flex gap-4 mt-2",children:e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-bold",children:"Next Term:"}),e.jsx("span",{className:"ml-2",children:l.nextTermBegins||""})]})})]})]})}export{ke as S};
