import{r as a,j as e}from"./index.UZcXu8dh.js";import{g as v,r as k}from"./api.CIjYu6Aj.js";const L=()=>{const[h,p]=a.useState([]),[d,g]=a.useState(""),[l,u]=a.useState(new Date().toISOString().split("T")[0]),[i,j]=a.useState([]),[f,x]=a.useState(!1),[m,o]=a.useState("");a.useEffect(()=>{y()},[]),a.useEffect(()=>{l&&N()},[l,d]);const y=async()=>{try{const s=await v();if(s.success){const n=s.data||[],r={};n.forEach(t=>{const c=`${t.class}-${t.session}-${t.term}`;r[c]||(r[c]={class_name:t.class,session:t.session,term:t.term})}),p(Object.values(r))}}catch(s){console.error("Load classes error:",s)}},N=async()=>{x(!0),o("");try{const s={date:l};if(d){const[r,t,c]=d.split("|");s.class_name=r,s.session=t,s.term=c}const n=await k(s);n.success?j(n.data||[]):o("Failed to load attendance")}catch(s){o("Error loading attendance"),console.error("Load attendance error:",s)}finally{x(!1)}},w=i.filter(s=>s.status==="present").length,b=i.filter(s=>s.status==="absent").length;return e.jsxs("div",{children:[e.jsx("div",{className:"flex justify-between items-center mb-6",children:e.jsx("h2",{className:"text-2xl font-bold text-gray-900",children:"View Attendance Records"})}),m&&e.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:m}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select Date"}),e.jsx("input",{type:"date",value:l,onChange:s=>u(s.target.value),max:new Date().toISOString().split("T")[0],className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Class (Optional)"}),e.jsxs("select",{value:d,onChange:s=>g(s.target.value),className:"w-full px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-indigo-500 focus:border-indigo-500",children:[e.jsx("option",{value:"",children:"All Classes"}),h.map((s,n)=>{const r=`${s.class_name}|${s.session}|${s.term}`;return e.jsxs("option",{value:r,children:[s.class_name," - ",s.session," (",s.term,")"]},n)})]})]})]})}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6 mb-6",children:[e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-blue-500 rounded-md p-3",children:e.jsx("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 4.354a4 4 0 110 5.292M15 21H3v-1a6 6 0 0112 0v1zm0 0h6v-1a6 6 0 00-9-5.197M13 7a4 4 0 11-8 0 4 4 0 018 0z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Total Students"}),e.jsx("p",{className:"text-2xl font-semibold text-gray-900",children:i.length})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-green-500 rounded-md p-3",children:e.jsx("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Present"}),e.jsx("p",{className:"text-2xl font-semibold text-green-600",children:w})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 bg-red-500 rounded-md p-3",children:e.jsx("svg",{className:"h-6 w-6 text-white",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M10 14l2-2m0 0l2-2m-2 2l-2-2m2 2l2 2m7-2a9 9 0 11-18 0 9 9 0 0118 0z"})})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("p",{className:"text-sm font-medium text-gray-600",children:"Absent"}),e.jsx("p",{className:"text-2xl font-semibold text-red-600",children:b})]})]})})]}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("h3",{className:"text-lg font-semibold text-gray-900",children:["Attendance for ",new Date(l).toLocaleDateString("en-US",{weekday:"long",year:"numeric",month:"long",day:"numeric"})]})}),e.jsx("div",{className:"p-6",children:f?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-indigo-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading attendance..."})]}):i.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx("svg",{className:"mx-auto h-12 w-12 text-gray-400",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 5H7a2 2 0 00-2 2v12a2 2 0 002 2h10a2 2 0 002-2V7a2 2 0 00-2-2h-2M9 5a2 2 0 002 2h2a2 2 0 002-2M9 5a2 2 0 012-2h2a2 2 0 012 2"})}),e.jsx("p",{className:"mt-4 text-gray-600",children:"No attendance records found for this date"})]}):e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Admission No"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student Name"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Session"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Term"}),e.jsx("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Marked By"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:i.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:s.admission_no}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium text-gray-900",children:s.student_name}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.class}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.session}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.term}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-center",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${s.status==="present"?"bg-green-100 text-green-800":"bg-red-100 text-red-800"}`,children:s.status==="present"?"Present":"Absent"})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:s.teacher_name||"N/A"})]},s.id))})]})})})]})]})};export{L as default};
