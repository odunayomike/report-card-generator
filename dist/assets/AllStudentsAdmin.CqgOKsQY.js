import{w as v,r as l,j as e,S as w,x as g,B as S,a2 as _}from"./index.UZcXu8dh.js";import{W as C}from"./api.CIjYu6Aj.js";import{S as k}from"./search.CQM06eWW.js";import{C as F}from"./chevron-left.BCC_ZOV5.js";function E(){const{toast:u}=v(),[c,y]=l.useState([]),[b,o]=l.useState(!0),[d,x]=l.useState(""),[t,m]=l.useState({school_id:"",class:"",session:"",term:""}),[r,i]=l.useState(1),[a,f]=l.useState(null);l.useEffect(()=>{h()},[r]);const h=async()=>{try{o(!0);const s={page:r,limit:50};d&&(s.search=d),t.school_id&&(s.school_id=t.school_id),t.class&&(s.class=t.class),t.session&&(s.session=t.session),t.term&&(s.term=t.term);const n=await C(s);y(n.students||[]),f(n.pagination)}catch(s){console.error("Failed to fetch students:",s),u.error("Failed to load students")}finally{o(!1)}},j=s=>{s.preventDefault(),i(1),h()},p=(s,n)=>{m({...t,[s]:n})},N=()=>{m({school_id:"",class:"",session:"",term:""}),x(""),i(1)};return e.jsxs(e.Fragment,{children:[e.jsx(w,{title:"All Students - Super Admin"}),e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"All Students"}),e.jsx("p",{className:"text-gray-500 mt-1",children:"View students across all schools"})]}),e.jsx("button",{onClick:N,className:"px-4 py-2 text-primary-600 border border-primary-600 rounded-lg hover:bg-primary-50 transition-colors",children:"Clear Filters"})]}),e.jsx("div",{className:"bg-white rounded-lg shadow p-6",children:e.jsxs("form",{onSubmit:j,className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[e.jsxs("div",{className:"lg:col-span-2",children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Search"}),e.jsxs("div",{className:"relative",children:[e.jsx(k,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx("input",{type:"text",placeholder:"Student name, admission no, or school...",value:d,onChange:s=>x(s.target.value),className:"pl-10 pr-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Class"}),e.jsx("input",{type:"text",placeholder:"e.g., JSS1",value:t.class,onChange:s=>p("class",s.target.value),className:"px-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Session"}),e.jsx("input",{type:"text",placeholder:"e.g., 2023/2024",value:t.session,onChange:s=>p("session",s.target.value),className:"px-4 py-2 w-full border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-transparent"})]})]}),e.jsx("div",{className:"flex justify-end",children:e.jsx("button",{type:"submit",className:"px-6 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700 transition-colors",children:"Apply Filters"})})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:b?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):c.length===0?e.jsxs("div",{className:"text-center py-12",children:[e.jsx(g,{className:"h-16 w-16 text-gray-300 mx-auto mb-4"}),e.jsx("p",{className:"text-gray-500",children:"No students found"})]}):e.jsxs(e.Fragment,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Student"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"School"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Class"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Session/Term"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subjects"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:c.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50",children:[e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx("div",{className:"flex-shrink-0 h-10 w-10 bg-primary-100 rounded-full flex items-center justify-center",children:e.jsx(g,{className:"h-5 w-5 text-primary-600"})}),e.jsxs("div",{className:"ml-4",children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.name}),e.jsx("div",{className:"text-sm text-gray-500",children:s.admission_no})]})]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(S,{className:"h-4 w-4 text-gray-400 mr-2"}),e.jsxs("div",{children:[e.jsx("div",{className:"text-sm font-medium text-gray-900",children:s.school_name}),e.jsx("div",{className:"text-xs text-gray-500",children:s.school_email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full bg-blue-100 text-blue-800",children:s.class})}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:[e.jsx("div",{children:s.session}),e.jsx("div",{className:"text-xs",children:s.term})]}),e.jsxs("td",{className:"px-6 py-4 whitespace-nowrap",children:[e.jsx("span",{className:"text-sm text-gray-900 font-medium",children:s.total_subjects}),e.jsx("span",{className:"text-sm text-gray-500",children:" subjects"})]}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:`px-2 py-1 inline-flex text-xs leading-5 font-semibold rounded-full ${s.subscription_status==="active"?"bg-green-100 text-green-800":s.subscription_status==="trial"?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"}`,children:s.subscription_status})})]},s.id))})]})}),a&&a.total_pages>1&&e.jsxs("div",{className:"bg-white px-4 py-3 flex items-center justify-between border-t border-gray-200",children:[e.jsxs("div",{className:"flex-1 flex justify-between sm:hidden",children:[e.jsx("button",{onClick:()=>i(s=>Math.max(1,s-1)),disabled:r===1,className:"relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>i(s=>Math.min(a.total_pages,s+1)),disabled:r===a.total_pages,className:"ml-3 relative inline-flex items-center px-4 py-2 border border-gray-300 text-sm font-medium rounded-md text-gray-700 bg-white hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:"Next"})]}),e.jsxs("div",{className:"hidden sm:flex-1 sm:flex sm:items-center sm:justify-between",children:[e.jsx("div",{children:e.jsxs("p",{className:"text-sm text-gray-700",children:["Showing ",e.jsx("span",{className:"font-medium",children:(r-1)*a.per_page+1})," to"," ",e.jsx("span",{className:"font-medium",children:Math.min(r*a.per_page,a.total_items)})," ","of ",e.jsx("span",{className:"font-medium",children:a.total_items})," results"]})}),e.jsx("div",{children:e.jsxs("nav",{className:"relative z-0 inline-flex rounded-md shadow-sm -space-x-px",children:[e.jsx("button",{onClick:()=>i(s=>Math.max(1,s-1)),disabled:r===1,className:"relative inline-flex items-center px-2 py-2 rounded-l-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:e.jsx(F,{className:"h-5 w-5"})}),e.jsxs("span",{className:"relative inline-flex items-center px-4 py-2 border border-gray-300 bg-white text-sm font-medium text-gray-700",children:["Page ",r," of ",a.total_pages]}),e.jsx("button",{onClick:()=>i(s=>Math.min(a.total_pages,s+1)),disabled:r===a.total_pages,className:"relative inline-flex items-center px-2 py-2 rounded-r-md border border-gray-300 bg-white text-sm font-medium text-gray-500 hover:bg-gray-50 disabled:bg-gray-100 disabled:cursor-not-allowed",children:e.jsx(_,{className:"h-5 w-5"})})]})})]})]})]})})]})]})}export{E as default};
