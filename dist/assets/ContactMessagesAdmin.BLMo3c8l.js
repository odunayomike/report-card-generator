import{c as v,w,r,A as S,j as e,B as _,X as x}from"./index.UZcXu8dh.js";import{M as g}from"./mail.B-H7KAXZ.js";import{C as k}from"./calendar.C-ct2omj.js";import{P as C}from"./phone.BXg1GupO.js";import{C as u}from"./check.UMeoQl_X.js";/**
 * @license lucide-react v0.561.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const M=[["path",{d:"M10 20a1 1 0 0 0 .553.895l2 1A1 1 0 0 0 14 21v-7a2 2 0 0 1 .517-1.341L21.74 4.67A1 1 0 0 0 21 3H3a1 1 0 0 0-.742 1.67l7.225 7.989A2 2 0 0 1 10 14z",key:"sc7q7i"}]],E=v("funnel",M);function L(){const{toast:m}=w(),[d,j]=r.useState([]),[y,h]=r.useState(!0),[i,b]=r.useState("all"),[t,n]=r.useState(null),[a,c]=r.useState({page:1,limit:50,total:0,total_pages:0});r.useEffect(()=>{N()},[i,a.page]);const N=async()=>{try{h(!0);const l=await(await fetch(`${S}/super-admin/get-contact-messages?status=${i}&page=${a.page}&limit=${a.limit}`,{credentials:"include"})).json();l.success?(j(l.messages),c(f=>({...f,total:l.total,total_pages:l.total_pages}))):m.error(l.message||"Failed to load messages")}catch(s){console.error("Failed to fetch messages:",s),m.error("Failed to load contact messages")}finally{h(!1)}},p=s=>new Date(s).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"2-digit",minute:"2-digit"}),o=s=>({sales:"Sales Inquiry",support:"Technical Support",billing:"Billing Question",feature:"Feature Request",other:"Other"})[s]||s;return y&&d.length===0?e.jsx("div",{className:"flex items-center justify-center h-64",children:e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"})}):e.jsxs("div",{className:"space-y-6",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Contact Messages"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View and manage all contact form submissions"})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(E,{className:"w-5 h-5 text-gray-500"}),e.jsxs("select",{value:i,onChange:s=>{b(s.target.value),c(l=>({...l,page:1}))},className:"px-4 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",children:[e.jsxs("option",{value:"all",children:["All Messages (",a.total,")"]}),e.jsx("option",{value:"pending",children:"Pending Email"}),e.jsx("option",{value:"sent",children:"Email Sent"})]})]})]}),d.length===0?e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 p-12 text-center",children:[e.jsx(g,{className:"w-16 h-16 text-gray-300 mx-auto mb-4"}),e.jsx("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"No messages found"}),e.jsx("p",{className:"text-gray-500",children:i==="all"?"No contact form submissions yet":`No ${i} messages`})]}):e.jsxs("div",{className:"bg-white rounded-lg border border-gray-200 overflow-hidden",children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"w-full",children:[e.jsx("thead",{className:"bg-gray-50 border-b border-gray-200",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Date"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Name & Contact"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Subject"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Message"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:d.map(s=>e.jsxs("tr",{className:"hover:bg-gray-50 cursor-pointer",onClick:()=>n(s),children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(k,{className:"w-4 h-4"}),p(s.created_at)]})}),e.jsx("td",{className:"px-6 py-4",children:e.jsxs("div",{className:"text-sm",children:[e.jsx("div",{className:"font-medium text-gray-900",children:s.name}),e.jsxs("div",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(g,{className:"w-3 h-3"}),s.email]}),s.phone&&s.phone!=="Not provided"&&e.jsxs("div",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(C,{className:"w-3 h-3"}),s.phone]}),s.school_name&&s.school_name!=="Not provided"&&e.jsxs("div",{className:"text-gray-500 flex items-center gap-1",children:[e.jsx(_,{className:"w-3 h-3"}),s.school_name]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsx("span",{className:"px-2 py-1 text-xs font-semibold rounded-full bg-blue-100 text-blue-800",children:o(s.subject)})}),e.jsx("td",{className:"px-6 py-4",children:e.jsx("div",{className:"text-sm text-gray-900 max-w-md truncate",children:s.message})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:s.email_sent==1?e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full bg-green-100 text-green-800",children:[e.jsx(u,{className:"w-3 h-3"}),"Email Sent"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-2 py-1 text-xs font-semibold rounded-full bg-yellow-100 text-yellow-800",children:[e.jsx(x,{className:"w-3 h-3"}),"Pending"]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm",children:e.jsx("button",{onClick:l=>{l.stopPropagation(),n(s)},className:"text-primary-600 hover:text-primary-900 font-medium",children:"View Details"})})]},s.id))})]})}),a.total_pages>1&&e.jsxs("div",{className:"px-6 py-4 border-t border-gray-200 flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-500",children:["Showing ",(a.page-1)*a.limit+1," to ",Math.min(a.page*a.limit,a.total)," of ",a.total," messages"]}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("button",{onClick:()=>c(s=>({...s,page:s.page-1})),disabled:a.page===1,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Previous"}),e.jsx("button",{onClick:()=>c(s=>({...s,page:s.page+1})),disabled:a.page===a.total_pages,className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Next"})]})]})]}),t&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex justify-between items-start mb-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Message Details"}),e.jsx("p",{className:"text-sm text-gray-500",children:p(t.created_at)})]}),e.jsx("button",{onClick:()=>n(null),className:"text-gray-400 hover:text-gray-600",children:e.jsx(x,{className:"w-6 h-6"})})]}),e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Name"}),e.jsx("p",{className:"text-base text-gray-900 mt-1",children:t.name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email"}),e.jsx("p",{className:"text-base text-gray-900 mt-1",children:e.jsx("a",{href:`mailto:${t.email}`,className:"text-primary-600 hover:underline",children:t.email})})]}),t.phone&&t.phone!=="Not provided"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Phone"}),e.jsx("p",{className:"text-base text-gray-900 mt-1",children:e.jsx("a",{href:`tel:${t.phone}`,className:"text-primary-600 hover:underline",children:t.phone})})]}),t.school_name&&t.school_name!=="Not provided"&&e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"School"}),e.jsx("p",{className:"text-base text-gray-900 mt-1",children:t.school_name})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Subject"}),e.jsx("p",{className:"text-base text-gray-900 mt-1",children:o(t.subject)})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"IP Address"}),e.jsx("p",{className:"text-base text-gray-900 mt-1",children:t.ip_address||"Unknown"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Message"}),e.jsx("div",{className:"mt-2 p-4 bg-gray-50 rounded-lg border border-gray-200",children:e.jsx("p",{className:"text-base text-gray-900 whitespace-pre-wrap",children:t.message})})]}),e.jsxs("div",{children:[e.jsx("label",{className:"text-sm font-medium text-gray-500",children:"Email Status"}),e.jsx("p",{className:"mt-1",children:t.email_sent==1?e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-semibold rounded-full bg-green-100 text-green-800",children:[e.jsx(u,{className:"w-4 h-4"}),"Email Sent Successfully"]}):e.jsxs("span",{className:"inline-flex items-center gap-1 px-3 py-1 text-sm font-semibold rounded-full bg-yellow-100 text-yellow-800",children:[e.jsx(x,{className:"w-4 h-4"}),"Email Sending Failed - Message Stored in Database"]})})]})]}),e.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[e.jsx("button",{onClick:()=>n(null),className:"px-4 py-2 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Close"}),e.jsx("a",{href:`mailto:${t.email}?subject=Re: ${o(t.subject)}`,className:"px-4 py-2 bg-primary-600 text-white rounded-lg hover:bg-primary-700",children:"Reply via Email"})]})]})})})]})}export{L as default};
