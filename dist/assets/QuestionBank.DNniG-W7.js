import{I as _e,r as l,A as g,j as e}from"./index.UZcXu8dh.js";const Fe=()=>{const{classes:B}=_e(),[V,ne]=l.useState([]),[b,le]=l.useState([]),[C,K]=l.useState([]),[ae,Y]=l.useState(!0),[w,n]=l.useState(""),[F,i]=l.useState(""),[h,O]=l.useState({subject:"",question_type:""}),[oe,j]=l.useState(!1),[k,_]=l.useState(null),[$,W]=l.useState(!1),[U,z]=l.useState(""),[G,y]=l.useState(""),[d,q]=l.useState([]),[ie,A]=l.useState(!1),[L,M]=l.useState(null),[ce,u]=l.useState(""),[Z,p]=l.useState(0),[P,f]=l.useState(!1),[c,E]=l.useState([]),[m,D]=l.useState(1),[I]=l.useState(10),[qe,de]=l.useState(0),[Le,Qe]=l.useState({question_text:"",question_type:"multiple_choice",subject:"",class:"",topic:"",difficulty:"medium",marks:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]}),[a,x]=l.useState({question_text:"",question_type:"multiple_choice",subject:"",class:"",topic:"",difficulty:"medium",marks:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]});l.useEffect(()=>{B&&ne(B)},[B]),l.useEffect(()=>{v(),ue(),D(1)},[h]);const ue=async()=>{try{const t=await(await fetch(`${g}/auth/check-session`,{credentials:"include"})).json();if(t.authenticated&&t.school&&t.school.available_subjects){const r=t.school.available_subjects.map(o=>o.toUpperCase());K(r)}}catch(s){console.error("Failed to load school settings:",s)}},ee=async()=>{if(y(""),!U.trim())return;const s=U.trim().toUpperCase();if(C.includes(s)){y("This subject already exists");return}try{const t=[...C,s],o=await(await fetch(`${g}/school/update-settings`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({available_subjects:t})})).json();o.success?(K(t),x({...a,subject:s}),z(""),W(!1),y("")):y("Failed to add subject: "+o.message)}catch(t){console.error("Error adding subject:",t),y("Failed to add subject. Please try again.")}},v=async()=>{Y(!0);try{const s=new URLSearchParams;h.subject&&s.append("subject",h.subject),h.question_type&&s.append("question_type",h.question_type);const r=await(await fetch(`${g}/cbt/questions?${s.toString()}`,{credentials:"include"})).json();r.success?(le(r.questions),de(r.total||r.questions.length)):n(r.message||"Failed to load questions")}catch(s){n("Failed to load questions"),console.error("Load questions error:",s)}finally{Y(!1)}},[xe,J]=l.useState(!1),me=async()=>{if(c.length===0){n("Please select questions to delete");return}J(!0)},he=async()=>{J(!1);try{const t=await(await fetch(`${g}/cbt/questions`,{method:"DELETE",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({ids:c})})).json();t.success?(i(`Successfully deleted ${c.length} question(s)`),setTimeout(()=>i(""),3e3),E([]),v()):n(t.message||"Failed to delete questions")}catch(s){n("Failed to delete questions"),console.error("Delete error:",s)}},pe=()=>{c.length===Q.length?E([]):E(Q.map(s=>s.id))},ge=s=>{E(t=>t.includes(s)?t.filter(r=>r!==s):[...t,s])},be=s=>{const t=d.filter((r,o)=>o!==s);q(t)},fe=async()=>{if(d.length===0){n("No questions to submit. Add at least one question to the batch.");return}n("");try{const t=await(await fetch(`${g}/cbt/questions`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({questions:d})})).json();if(t.success){const r=t.count||d.length;i(`Successfully added ${r} question(s)!`),setTimeout(()=>i(""),5e3),q([]),j(!1),N(),v()}else n(t.message||"Failed to add questions. Please try again.")}catch(s){n("Failed to submit questions"),console.error("Submit batch error:",s)}},R=()=>(n(""),!a.question_text||!a.subject||!a.class?(n("Question text, subject, and class are required"),!1):a.options.filter(r=>r.is_correct).length!==1?(n("Exactly one option must be marked as correct"),!1):a.options.filter(r=>!r.text.trim()).length>0?(n("All option fields must be filled"),!1):!0),je=async()=>{if(!R())return;const s=[...d,{...a}];try{const r=await(await fetch(`${g}/cbt/questions`,{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify(s.length>1?{questions:s}:s[0])})).json();if(r.success){const o=r.count||1;i(`Successfully added ${o} question(s)!`),setTimeout(()=>i(""),5e3),q([]),j(!1),N(),v()}else n(r.message||"Failed to add questions. Please try again.")}catch(t){n("Failed to submit questions"),console.error("Submit now error:",t)}},ye=()=>{if(!R())return;q([...d,{...a}]);const s=a.subject,t=a.class;N(),x(r=>({...r,subject:s,class:t})),i(`Question added to batch! (${d.length+1} questions ready)`),setTimeout(()=>i(""),3e3)},ve=async s=>{if(s.preventDefault(),n(""),k){if(!R())return;try{const r=await(await fetch(`${g}/cbt/questions`,{method:"PUT",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({...a,id:k.id})})).json();r.success?(j(!1),_(null),N(),i("Question updated successfully!"),setTimeout(()=>i(""),3e3),v()):n(r.message||"Failed to save question")}catch(t){n("Failed to save question"),console.error("Save question error:",t)}}},[se,H]=l.useState(null),Ne=s=>{H(s)},we=async()=>{const s=se;H(null);try{const r=await(await fetch(`${g}/cbt/questions?id=${s}`,{method:"DELETE",credentials:"include"})).json();r.success?(i("Question deleted successfully"),setTimeout(()=>i(""),3e3),v()):n(r.message||"Failed to delete question")}catch(t){n("Failed to delete question"),console.error("Delete question error:",t)}},N=()=>{x({question_text:"",question_type:"multiple_choice",subject:"",class:"",topic:"",difficulty:"medium",marks:1,options:[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]})},ke=s=>{_(s),x({question_text:s.question_text,question_type:s.question_type,subject:s.subject,class:s.class||"",topic:s.topic||"",difficulty:s.difficulty,marks:s.marks,options:s.options||[{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1},{text:"",is_correct:!1}]}),j(!0)},te=(s,t,r)=>{const o=[...a.options];t==="is_correct"&&r?o.forEach((T,Ce)=>{T.is_correct=Ce===s}):o[s][t]=r,x({...a,options:o})},Se=async s=>{if(s.preventDefault(),!L){n("Please select a file to import");return}const t=new FormData;t.append("file",L),n(""),f(!0),p(0),u("Preparing upload...");const r=new XMLHttpRequest;r.upload.addEventListener("progress",o=>{if(o.lengthComputable){const T=Math.round(o.loaded/o.total*100);p(T),T<100?u(`Uploading file... ${T}%`):u("Processing file...")}}),r.addEventListener("load",()=>{if(r.status===200)try{const o=JSON.parse(r.responseText);o.success?(i(`Successfully imported ${o.count} question(s)!`),setTimeout(()=>i(""),5e3),A(!1),M(null),u(""),p(0),f(!1),v()):(n(o.message||"Failed to import questions"),u(""),p(0),f(!1))}catch{n("Failed to process server response"),u(""),p(0),f(!1)}else{try{const o=JSON.parse(r.responseText);n(o.message||"Failed to import questions")}catch{n("Failed to import questions. Server error.")}u(""),p(0),f(!1)}}),r.addEventListener("error",()=>{n("Network error. Please check your connection and try again."),u(""),p(0),f(!1)}),r.addEventListener("abort",()=>{n("Upload cancelled"),u(""),p(0),f(!1)}),r.open("POST",`${g}/cbt/import-questions`),r.withCredentials=!0,r.send(t)},X=m*I,re=X-I,Q=b.slice(re,X),S=Math.ceil(b.length/I);return ae&&b.length===0?e.jsx("div",{className:"flex items-center justify-center py-12",children:e.jsxs("div",{className:"text-center",children:[e.jsx("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-green-600 mx-auto"}),e.jsx("p",{className:"mt-4 text-gray-600",children:"Loading questions..."})]})}):e.jsxs("div",{children:[e.jsxs("div",{className:"mb-8 flex justify-between items-center",children:[e.jsxs("div",{children:[e.jsx("h1",{className:"text-3xl font-bold text-gray-900",children:"Question Bank"}),e.jsx("p",{className:"text-gray-600 mt-2",children:"Create and manage your CBT questions"})]}),e.jsxs("div",{className:"flex gap-3",children:[e.jsxs("button",{onClick:()=>A(!0),className:"bg-primary-500 text-white px-6 py-2 rounded-lg hover:bg-primary-600 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M7 16a4 4 0 01-.88-7.903A5 5 0 1115.9 6L16 6a5 5 0 011 9.9M15 13l-3-3m0 0l-3 3m3-3v12"})}),"Import Questions"]}),e.jsx("button",{onClick:()=>{j(!0),_(null),N()},className:"bg-green-600 text-white px-6 py-2 rounded-lg hover:bg-green-700 transition-colors",children:"+ Add Question"})]})]}),w&&e.jsx("div",{className:"bg-red-50 border border-red-400 text-red-700 px-4 py-3 rounded mb-6",children:w}),F&&e.jsx("div",{className:"bg-green-50 border border-green-400 text-green-700 px-4 py-3 rounded mb-6",children:F}),oe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-3xl w-full max-h-[90vh] overflow-y-auto",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:k?"Edit Question":"Add New Question"}),e.jsx("button",{onClick:()=>{j(!1),_(null),N()},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:ve,className:"p-6 space-y-6",children:[w&&e.jsx("div",{className:"bg-red-50 border-2 border-red-400 text-red-700 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:w})]})}),F&&e.jsx("div",{className:"bg-green-50 border-2 border-green-400 text-green-700 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-green-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:F})]})}),!k&&d.length>0&&e.jsxs("div",{className:"bg-primary-50 border-2 border-primary-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-3",children:[e.jsxs("h3",{className:"font-semibold text-primary-900",children:["Questions Ready to Submit (",d.length,")"]}),e.jsx("button",{type:"button",onClick:fe,className:"px-4 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 text-sm font-medium",children:"Submit All Questions"})]}),e.jsx("div",{className:"space-y-2 max-h-40 overflow-y-auto",children:d.map((s,t)=>e.jsxs("div",{className:"flex items-start justify-between bg-white p-3 rounded border border-primary-200",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("p",{className:"text-sm font-medium text-gray-900 line-clamp-1",children:[t+1,". ",s.question_text]}),e.jsxs("p",{className:"text-xs text-gray-500 mt-1",children:[s.subject," • ",s.class," • ",s.marks," mark(s)"]})]}),e.jsx("button",{type:"button",onClick:()=>be(t),className:"ml-2 text-red-500 hover:text-red-700",title:"Remove from batch",children:e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]},t))})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Question Text *"}),e.jsx("textarea",{value:a.question_text,onChange:s=>x({...a,question_text:s.target.value}),rows:3,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Class *"}),e.jsxs("select",{value:a.class,onChange:s=>x({...a,class:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[e.jsx("option",{value:"",children:"-- Select a class --"}),V.filter(s=>s.class_name&&s.session&&s.term).map(s=>e.jsxs("option",{value:s.class_name,children:[s.class_name," - ",s.session," (",s.term,")"]},s.id))]}),V.length===0&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:"No classes available. Please add students first."})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Subject *"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:a.subject,onChange:s=>x({...a,subject:s.target.value}),className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0,children:[e.jsx("option",{value:"",children:"-- Select a subject --"}),C.map((s,t)=>e.jsx("option",{value:s,children:s},t))]}),e.jsx("button",{type:"button",onClick:()=>W(!$),className:"px-4 py-2 bg-green-50 text-green-700 border border-green-300 rounded-lg hover:bg-green-100 transition-colors whitespace-nowrap",title:"Add new subject",children:"+ Add New"})]}),$&&e.jsxs("div",{className:"mt-3 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:[e.jsx("h5",{className:"text-sm font-semibold text-gray-900 mb-2",children:"Add New Subject"}),G&&e.jsx("div",{className:"mb-3 p-2 bg-red-50 border border-red-200 text-red-700 text-sm rounded",children:G}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx("input",{type:"text",value:U,onChange:s=>{z(s.target.value),y("")},onKeyPress:s=>{s.key==="Enter"&&(s.preventDefault(),ee())},placeholder:"e.g., Mathematics, Physics",className:"flex-1 px-3 py-2 border border-gray-300 rounded-md focus:outline-none focus:ring-2 focus:ring-green-500"}),e.jsx("button",{type:"button",onClick:ee,className:"px-4 py-2 bg-green-600 text-white rounded-md hover:bg-green-700 transition-colors",children:"Add"}),e.jsx("button",{type:"button",onClick:()=>{W(!1),z(""),y("")},className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400 transition-colors",children:"Cancel"})]}),e.jsx("p",{className:"text-xs text-gray-600 mt-2",children:"Subject will be saved in UPPERCASE and available for all exams and questions."})]}),C.length===0&&!$&&e.jsx("p",{className:"mt-1 text-sm text-gray-500",children:'No subjects configured. Click "+ Add New" to add subjects.'})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Topic (Optional)"}),e.jsx("input",{type:"text",value:a.topic,onChange:s=>x({...a,topic:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Difficulty"}),e.jsxs("select",{value:a.difficulty,onChange:s=>x({...a,difficulty:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"easy",children:"Easy"}),e.jsx("option",{value:"medium",children:"Medium"}),e.jsx("option",{value:"hard",children:"Hard"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Marks"}),e.jsx("input",{type:"number",value:a.marks,onChange:s=>x({...a,marks:parseInt(s.target.value)}),min:"1",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500"})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Answer Options *"}),e.jsx("div",{className:"space-y-3",children:a.options.map((s,t)=>e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx("input",{type:"radio",name:"correct_answer",checked:s.is_correct,onChange:()=>te(t,"is_correct",!0),className:"w-4 h-4 text-green-600"}),e.jsx("input",{type:"text",value:s.text,onChange:r=>te(t,"text",r.target.value),placeholder:`Option ${t+1}`,className:"flex-1 px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",required:!0})]},t))}),e.jsx("p",{className:"text-sm text-gray-500 mt-2",children:"Select the radio button next to the correct answer"})]}),e.jsxs("div",{className:"flex justify-between items-center gap-3 pt-4 border-t",children:[e.jsx("button",{type:"button",onClick:()=>{j(!1),_(null),q([]),N()},className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:k?"Cancel":"Close"}),k?e.jsx("button",{type:"submit",className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700",children:"Update Question"}):e.jsxs("div",{className:"flex gap-3 items-center",children:[e.jsxs("button",{type:"button",onClick:ye,className:"px-6 py-2 bg-gray-600 text-white rounded-lg hover:bg-gray-700 font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 6v6m0 0v6m0-6h6m-6 0H6"})}),"Add to Batch & Continue"]}),e.jsxs("button",{type:"button",onClick:je,className:"px-6 py-2 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M5 13l4 4L19 7"})}),"Submit Now ",d.length>0&&`(${d.length+1})`]})]})]})]})]})}),xe&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Questions"}),e.jsxs("p",{className:"text-sm text-gray-600 mt-1",children:["Are you sure you want to delete ",c.length," question(s)? This action cannot be undone."]})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>J(!1),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsxs("button",{onClick:he,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:["Delete ",c.length," Question(s)"]})]})]})})}),se&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsx("div",{className:"bg-white rounded-lg max-w-md w-full",children:e.jsxs("div",{className:"p-6",children:[e.jsxs("div",{className:"flex items-center gap-4 mb-4",children:[e.jsx("div",{className:"flex-shrink-0 w-12 h-12 rounded-full bg-red-100 flex items-center justify-center",children:e.jsx("svg",{className:"w-6 h-6 text-red-600",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"})})}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold text-gray-900",children:"Delete Question"}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:"Are you sure you want to delete this question? This action cannot be undone."})]})]}),e.jsxs("div",{className:"flex justify-end gap-3 mt-6",children:[e.jsx("button",{onClick:()=>H(null),className:"px-4 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50",children:"Cancel"}),e.jsx("button",{onClick:we,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700",children:"Delete Question"})]})]})})}),ie&&e.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:e.jsxs("div",{className:"bg-white rounded-lg max-w-2xl w-full",children:[e.jsxs("div",{className:"sticky top-0 bg-white border-b px-6 py-4 flex justify-between items-center",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Import Questions from File"}),e.jsx("button",{onClick:()=>{A(!1),M(null),u(""),n("")},className:"text-gray-500 hover:text-gray-700",children:e.jsx("svg",{className:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M6 18L18 6M6 6l12 12"})})})]}),e.jsxs("form",{onSubmit:Se,className:"p-6 space-y-6",children:[w&&e.jsx("div",{className:"bg-red-50 border-2 border-red-400 text-red-700 px-4 py-3 rounded-lg",children:e.jsxs("div",{className:"flex items-start gap-2",children:[e.jsx("svg",{className:"w-5 h-5 text-red-600 flex-shrink-0 mt-0.5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M12 8v4m0 4h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"})}),e.jsx("span",{className:"font-medium",children:w})]})}),e.jsxs("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:[e.jsx("h3",{className:"font-semibold text-blue-900 mb-2",children:"Import Instructions"}),e.jsxs("div",{className:"text-sm text-blue-800 space-y-2",children:[e.jsx("p",{className:"font-semibold",children:"Currently, we only support TXT (text) format."}),e.jsx("p",{children:"Your text file should follow this format:"}),e.jsxs("div",{className:"bg-white p-3 rounded mt-2 font-mono text-xs",children:[e.jsx("p",{children:"Subject: MATHEMATICS"}),e.jsx("p",{children:"Class: JSS 1"}),e.jsx("p",{children:"Topic: Algebra (optional)"}),e.jsx("p",{children:"Difficulty: medium (optional)"}),e.jsx("p",{children:"Marks: 1 (optional)"}),e.jsx("p",{className:"mt-2",children:"Question 1: What is 2 + 2?"}),e.jsx("p",{children:"A. 3"}),e.jsx("p",{children:"B. 4 (correct)"}),e.jsx("p",{children:"C. 5"}),e.jsx("p",{children:"D. 6"}),e.jsx("p",{className:"mt-2",children:"Question 2: What is 3 x 3?"}),e.jsx("p",{children:"A. 6"}),e.jsx("p",{children:"B. 8"}),e.jsx("p",{children:"C. 9 (correct)"}),e.jsx("p",{children:"D. 12"})]}),e.jsxs("div",{className:"mt-2 space-y-1",children:[e.jsx("p",{children:"• Mark correct answers with (correct) or *"}),e.jsx("p",{children:"• Only TXT format is supported for now"}),e.jsx("p",{children:"• PDF and DOCX support coming soon"}),e.jsx("p",{children:"• All questions will use the same subject, class, and settings"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select TXT File *"}),e.jsx("input",{type:"file",accept:".txt",onChange:s=>M(s.target.files[0]),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-primary-500",required:!0}),L&&e.jsxs("p",{className:"text-sm text-gray-600 mt-2",children:["Selected: ",L.name]}),e.jsx("p",{className:"text-xs text-gray-500 mt-1",children:"Only .txt files are accepted"})]}),P&&e.jsx("div",{className:"space-y-3",children:e.jsxs("div",{className:"bg-primary-50 border border-primary-200 rounded-lg p-4",children:[e.jsxs("div",{className:"flex items-center justify-between mb-2",children:[e.jsx("span",{className:"text-sm font-medium text-primary-700",children:ce}),e.jsxs("span",{className:"text-sm font-bold text-primary-700",children:[Z,"%"]})]}),e.jsx("div",{className:"w-full bg-primary-200 rounded-full h-3 overflow-hidden",children:e.jsx("div",{className:"bg-primary-600 h-full rounded-full transition-all duration-300 ease-out",style:{width:`${Z}%`},children:e.jsx("div",{className:"h-full w-full bg-gradient-to-r from-transparent via-white to-transparent opacity-30 animate-pulse"})})})]})}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx("button",{type:"button",onClick:()=>{A(!1),M(null),u(""),p(0),f(!1),n("")},disabled:P,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 disabled:opacity-50 disabled:cursor-not-allowed",children:"Cancel"}),e.jsx("button",{type:"submit",disabled:!L||P,className:"px-6 py-2 bg-primary-500 text-white rounded-lg hover:bg-primary-600 disabled:opacity-50 disabled:cursor-not-allowed flex items-center gap-2",children:P?e.jsxs(e.Fragment,{children:[e.jsxs("svg",{className:"animate-spin h-5 w-5",fill:"none",viewBox:"0 0 24 24",children:[e.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),e.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),"Processing..."]}):"Import Questions"})]})]})]})}),e.jsx("div",{className:"bg-white rounded-lg shadow p-4 mb-6",children:e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Subject"}),e.jsxs("select",{value:h.subject,onChange:s=>O({...h,subject:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"All Subjects"}),C.map((s,t)=>e.jsx("option",{value:s,children:s},t))]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Filter by Type"}),e.jsxs("select",{value:h.question_type,onChange:s=>O({...h,question_type:s.target.value}),className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-green-500",children:[e.jsx("option",{value:"",children:"All Types"}),e.jsx("option",{value:"multiple_choice",children:"Multiple Choice"}),e.jsx("option",{value:"true_false",children:"True/False"})]})]}),e.jsx("div",{className:"flex items-end",children:e.jsx("button",{onClick:()=>O({subject:"",question_type:""}),className:"px-4 py-2 text-gray-600 hover:text-gray-800",children:"Clear Filters"})})]})}),e.jsxs("div",{className:"bg-white rounded-lg shadow",children:[e.jsx("div",{className:"px-6 py-4 border-b border-gray-200",children:e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[b.length>0&&e.jsx("input",{type:"checkbox",checked:c.length===Q.length&&Q.length>0,onChange:pe,className:"w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-green-500"}),e.jsxs("h2",{className:"text-lg font-semibold text-gray-900",children:["All Questions (",b.length,")"]}),c.length>0&&e.jsxs("span",{className:"text-sm text-gray-600",children:["(",c.length," selected)"]})]}),c.length>0&&e.jsxs("button",{onClick:me,className:"px-4 py-2 bg-red-600 text-white rounded-lg hover:bg-red-700 transition-colors flex items-center gap-2",children:[e.jsx("svg",{className:"w-5 h-5",fill:"none",viewBox:"0 0 24 24",stroke:"currentColor",children:e.jsx("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:2,d:"M19 7l-.867 12.142A2 2 0 0116.138 21H7.862a2 2 0 01-1.995-1.858L5 7m5 4v6m4-6v6m1-10V4a1 1 0 00-1-1h-4a1 1 0 00-1 1v3M4 7h16"})}),"Delete Selected (",c.length,")"]})]})}),e.jsx("div",{className:"divide-y divide-gray-200",children:b.length===0?e.jsx("div",{className:"text-center py-12 text-gray-500",children:'No questions found. Click "Add Question" to create your first question.'}):e.jsxs(e.Fragment,{children:[Q.map(s=>e.jsx("div",{className:`p-6 hover:bg-gray-50 transition-colors ${c.includes(s.id)?"bg-green-50":""}`,children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("input",{type:"checkbox",checked:c.includes(s.id),onChange:()=>ge(s.id),className:"mt-1 w-5 h-5 text-green-600 rounded border-gray-300 focus:ring-green-500"}),e.jsx("div",{className:"flex-1",children:e.jsxs("div",{className:"flex justify-between items-start mb-3",children:[e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-3 mb-2",children:[e.jsx("span",{className:"px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded",children:s.subject}),s.class&&e.jsx("span",{className:"px-2 py-1 bg-purple-100 text-purple-800 text-xs rounded",children:s.class}),s.topic&&e.jsx("span",{className:"px-2 py-1 bg-gray-100 text-gray-700 text-xs rounded",children:s.topic}),e.jsx("span",{className:`px-2 py-1 text-xs rounded ${s.difficulty==="easy"?"bg-green-100 text-green-800":s.difficulty==="hard"?"bg-red-100 text-red-800":"bg-yellow-100 text-yellow-800"}`,children:s.difficulty}),e.jsxs("span",{className:"text-sm text-gray-500",children:[s.marks," mark(s)"]})]}),e.jsx("p",{className:"text-gray-900 font-medium",children:s.question_text})]}),e.jsxs("div",{className:"flex gap-2 ml-4",children:[e.jsx("button",{onClick:()=>ke(s),className:"text-blue-600 hover:text-blue-800",children:"Edit"}),e.jsx("button",{onClick:()=>Ne(s.id),className:"text-red-600 hover:text-red-800",children:"Delete"})]})]})})]})},s.id)),S>1&&e.jsx("div",{className:"px-6 py-4 bg-gray-50 border-t border-gray-200",children:e.jsxs("div",{className:"flex items-center justify-between",children:[e.jsxs("div",{className:"text-sm text-gray-700",children:["Showing ",re+1," to ",Math.min(X,b.length)," of ",b.length," questions"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx("button",{onClick:()=>D(s=>Math.max(s-1,1)),disabled:m===1,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Previous"}),e.jsx("div",{className:"flex gap-1",children:Array.from({length:S},(s,t)=>t+1).map(s=>{const t=s===1||s===S||s>=m-1&&s<=m+1;return s===m-2&&m>3||s===m+2&&m<S-2?e.jsx("span",{className:"px-2 py-2 text-gray-500",children:"..."},s):t?e.jsx("button",{onClick:()=>D(s),className:`px-3 py-2 rounded-lg text-sm ${m===s?"bg-green-600 text-white":"border border-gray-300 hover:bg-gray-100"}`,children:s},s):null})}),e.jsx("button",{onClick:()=>D(s=>Math.min(s+1,S)),disabled:m===S,className:"px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-100 disabled:opacity-50 disabled:cursor-not-allowed text-sm",children:"Next"})]})]})})]})})]})]})};export{Fe as default};
